{"ast":null,"code":"import _regeneratorRuntime from \"/Users/janei/Desktop/dapp/crowdfunding/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/janei/Desktop/dapp/crowdfunding/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/janei/Desktop/dapp/crowdfunding/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/janei/Desktop/dapp/crowdfunding/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/janei/Desktop/dapp/crowdfunding/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/janei/Desktop/dapp/crowdfunding/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/janei/Desktop/dapp/crowdfunding/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/janei/Desktop/dapp/crowdfunding/src/display/supporterFundingTab/SupporterFundingTab.js\";\nimport React, { Component } from 'react';\nimport { approveRequest, getFundingDetails, showRequests } from '../../eth/interaction';\nimport CardList from \"../common/CardList\";\nimport RequestTable from \"../common/RequestTable\";\nimport { Button } from 'semantic-ui-react';\n\nvar SupporterFundingTab =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(SupporterFundingTab, _Component);\n\n  function SupporterFundingTab() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, SupporterFundingTab);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(SupporterFundingTab)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      supporterFundingDetails: [],\n      seletedFundingDetail: '',\n      requests: [] //所有的花费请求\n\n    };\n\n    _this.onCardClick = function (seletedFundingDetail) {\n      console.log(\"ccc :\", seletedFundingDetail);\n\n      _this.setState({\n        seletedFundingDetail: seletedFundingDetail\n      });\n    };\n\n    _this.handleShowRequests =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var fundingAddress, requests;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              fundingAddress = _this.state.seletedFundingDetail.fundingAddress;\n              _context.prev = 1;\n              _context.next = 4;\n              return showRequests(fundingAddress);\n\n            case 4:\n              requests = _context.sent;\n              console.log('requests:', requests);\n\n              _this.setState({\n                requests: requests\n              });\n\n              _context.next = 12;\n              break;\n\n            case 9:\n              _context.prev = 9;\n              _context.t0 = _context[\"catch\"](1);\n              console.log(_context.t0);\n\n            case 12:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this, [[1, 9]]);\n    }));\n\n    _this.handleApprove =\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(index) {\n        var res;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                console.log('批准按钮点击!', index); //1. 指定合约地址\n                //2. 指定选择请求的index\n\n                _context2.prev = 1;\n                _context2.next = 4;\n                return approveRequest(_this.state.seletedFundingDetail.fundingAddress, index);\n\n              case 4:\n                res = _context2.sent;\n                _context2.next = 10;\n                break;\n\n              case 7:\n                _context2.prev = 7;\n                _context2.t0 = _context2[\"catch\"](1);\n                console.log(_context2.t0);\n\n              case 10:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[1, 7]]);\n      }));\n\n      return function (_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    return _this;\n  }\n\n  _createClass(SupporterFundingTab, [{\n    key: \"componentWillMount\",\n    value: function () {\n      var _componentWillMount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3() {\n        var supporterFundingDetails;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return getFundingDetails(3);\n\n              case 2:\n                supporterFundingDetails = _context3.sent;\n                // console.table(creatorFundingDetails)\n                console.log('xxxx', supporterFundingDetails);\n                this.setState({\n                  supporterFundingDetails: supporterFundingDetails\n                });\n\n              case 5:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function componentWillMount() {\n        return _componentWillMount.apply(this, arguments);\n      }\n\n      return componentWillMount;\n    }() //传递一个回调函数给CardList，将所选择的Card的详细信息返回来\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          supporterFundingDetails = _this$state.supporterFundingDetails,\n          seletedFundingDetail = _this$state.seletedFundingDetail,\n          requests = _this$state.requests;\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 63\n        },\n        __self: this\n      }, React.createElement(CardList, {\n        details: supporterFundingDetails,\n        onCardClick: this.onCardClick,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 64\n        },\n        __self: this\n      }), seletedFundingDetail && React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 68\n        },\n        __self: this\n      }, React.createElement(Button, {\n        onClick: this.handleShowRequests,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69\n        },\n        __self: this\n      }, \"\\u7533\\u8BF7\\u8BE6\\u60C5\"), React.createElement(RequestTable, {\n        requests: requests,\n        handleApprove: this.handleApprove,\n        pageKey: 3,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return SupporterFundingTab;\n}(Component);\n\nexport default SupporterFundingTab;","map":{"version":3,"sources":["/Users/janei/Desktop/dapp/crowdfunding/src/display/supporterFundingTab/SupporterFundingTab.js"],"names":["React","Component","approveRequest","getFundingDetails","showRequests","CardList","RequestTable","Button","SupporterFundingTab","state","supporterFundingDetails","seletedFundingDetail","requests","onCardClick","console","log","setState","handleShowRequests","fundingAddress","handleApprove","index","res"],"mappings":";;;;;;;;AAAA,OAAOA,KAAP,IAAeC,SAAf,QAA+B,OAA/B;AACA,SAAQC,cAAR,EAAwBC,iBAAxB,EAA2CC,YAA3C,QAA8D,uBAA9D;AACA,OAAOC,QAAP,MAAqB,oBAArB;AACA,OAAOC,YAAP,MAAyB,wBAAzB;AACA,SAAQC,MAAR,QAAqB,mBAArB;;IAEMC,mB;;;;;;;;;;;;;;;;;UAEFC,K,GAAQ;AACJC,MAAAA,uBAAuB,EAAE,EADrB;AAEJC,MAAAA,oBAAoB,EAAE,EAFlB;AAGJC,MAAAA,QAAQ,EAAE,EAHN,CAGU;;AAHV,K;;UAmBRC,W,GAAc,UAACF,oBAAD,EAA0B;AACpCG,MAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqBJ,oBAArB;;AAEA,YAAKK,QAAL,CAAc;AACVL,QAAAA,oBAAoB,EAApBA;AADU,OAAd;AAGH,K;;UAEDM,kB;;;;6BAAqB;AAAA;AAAA;AAAA;AAAA;AAAA;AACbC,cAAAA,cADa,GACI,MAAKT,KAAL,CAAWE,oBAAX,CAAgCO,cADpC;AAAA;AAAA;AAAA,qBAGQd,YAAY,CAACc,cAAD,CAHpB;;AAAA;AAGTN,cAAAA,QAHS;AAIbE,cAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ,EAAyBH,QAAzB;;AACA,oBAAKI,QAAL,CAAc;AAACJ,gBAAAA,QAAQ,EAARA;AAAD,eAAd;;AALa;AAAA;;AAAA;AAAA;AAAA;AAQbE,cAAAA,OAAO,CAACC,GAAR;;AARa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,K;;UAYrBI,a;;;;;+BAAgB,kBAAOC,KAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACZN,gBAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ,EAAuBK,KAAvB,EADY,CAEZ;AACA;;AAHY;AAAA;AAAA,uBAKQlB,cAAc,CAAC,MAAKO,KAAL,CAAWE,oBAAX,CAAgCO,cAAjC,EAAiDE,KAAjD,CALtB;;AAAA;AAKJC,gBAAAA,GALI;AAAA;AAAA;;AAAA;AAAA;AAAA;AAORP,gBAAAA,OAAO,CAACC,GAAR;;AAPQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;;;;;;;;;;;;;;;;;;;;;;uBA/BwBZ,iBAAiB,CAAC,CAAD,C;;;AAAjDO,gBAAAA,uB;AACJ;AACAI,gBAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ,EAAoBL,uBAApB;AAGA,qBAAKM,QAAL,CAAc;AACVN,kBAAAA,uBAAuB,EAAvBA;AADU,iBAAd;;;;;;;;;;;;;;;QAKJ;;;;6BAiCS;AAAA,wBAC2D,KAAKD,KADhE;AAAA,UACAC,uBADA,eACAA,uBADA;AAAA,UACyBC,oBADzB,eACyBA,oBADzB;AAAA,UAC+CC,QAD/C,eAC+CA,QAD/C;AAEL,aACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,QAAD;AAAU,QAAA,OAAO,EAAEF,uBAAnB;AACU,QAAA,WAAW,EAAE,KAAKG,WAD5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,EAKQF,oBAAoB,IAAK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACrB,oBAAC,MAAD;AAAQ,QAAA,OAAO,EAAE,KAAKM,kBAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oCADqB,EAErB,oBAAC,YAAD;AAAc,QAAA,QAAQ,EAAEL,QAAxB;AACc,QAAA,aAAa,EAAE,KAAKO,aADlC;AAEc,QAAA,OAAO,EAAE,CAFvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFqB,CALjC,CADJ;AAgBH;;;;EAvE6BlB,S;;AA0ElC,eAAeO,mBAAf","sourcesContent":["import React, {Component} from 'react';\nimport {approveRequest, getFundingDetails, showRequests} from '../../eth/interaction'\nimport CardList from \"../common/CardList\";\nimport RequestTable from \"../common/RequestTable\";\nimport {Button} from 'semantic-ui-react'\n\nclass SupporterFundingTab extends Component {\n\n    state = {\n        supporterFundingDetails: [],\n        seletedFundingDetail: '',\n        requests: [], //所有的花费请求\n    }\n\n    async componentWillMount() {\n        //funding地址的数组\n        let supporterFundingDetails = await getFundingDetails(3)\n        // console.table(creatorFundingDetails)\n        console.log('xxxx', supporterFundingDetails)\n\n\n        this.setState({\n            supporterFundingDetails\n        })\n    }\n\n    //传递一个回调函数给CardList，将所选择的Card的详细信息返回来\n    onCardClick = (seletedFundingDetail) => {\n        console.log(\"ccc :\", seletedFundingDetail)\n\n        this.setState({\n            seletedFundingDetail\n        })\n    }\n\n    handleShowRequests = async () => {\n        let fundingAddress = this.state.seletedFundingDetail.fundingAddress\n        try {\n            let requests = await showRequests(fundingAddress)\n            console.log('requests:', requests)\n            this.setState({requests})\n\n        } catch (e) {\n            console.log(e)\n        }\n    }\n\n    handleApprove = async (index) => {\n        console.log('批准按钮点击!', index)\n        //1. 指定合约地址\n        //2. 指定选择请求的index\n        try {\n            let res = await approveRequest(this.state.seletedFundingDetail.fundingAddress, index)\n        } catch (e) {\n            console.log(e)\n        }\n\n    }\n\n    render() {\n        let {supporterFundingDetails, seletedFundingDetail, requests} = this.state\n        return (\n            <div>\n                <CardList details={supporterFundingDetails}\n                          onCardClick={this.onCardClick}\n                />\n                {\n                    seletedFundingDetail && (<div>\n                        <Button onClick={this.handleShowRequests}>申请详情</Button>\n                        <RequestTable requests={requests}\n                                      handleApprove={this.handleApprove}\n                                      pageKey={3}\n                        />\n                    </div>)\n                }\n            </div>\n        )\n    }\n}\n\nexport default SupporterFundingTab\n"]},"metadata":{},"sourceType":"module"}