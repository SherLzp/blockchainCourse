{"ast":null,"code":"import _regeneratorRuntime from \"/Users/janei/Desktop/dapp/crowdfunding/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/janei/Desktop/dapp/crowdfunding/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/Users/janei/Desktop/dapp/crowdfunding/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/Users/janei/Desktop/dapp/crowdfunding/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/janei/Desktop/dapp/crowdfunding/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/janei/Desktop/dapp/crowdfunding/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/janei/Desktop/dapp/crowdfunding/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/janei/Desktop/dapp/crowdfunding/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/janei/Desktop/dapp/crowdfunding/src/display/creatorFundingTab/CreatorFundingTab.js\";\nimport React, { Component } from 'react';\nimport { createRequest, finalizeRequest, getFundingDetails, showRequests } from '../../eth/interaction';\nimport CardList from '../common/CardList';\nimport CreateFundingForm from './CreateFundingForm';\nimport { Button, Form, Label, Segment } from 'semantic-ui-react';\nimport RequestTable from \"../common/RequestTable\";\n\nvar CreatorFundingTab =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(CreatorFundingTab, _Component);\n\n  function CreatorFundingTab() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, CreatorFundingTab);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(CreatorFundingTab)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      creatorFundingDetails: [],\n      seletedFundingDetail: '',\n      requestDesc: '',\n      //purpose ， 项目方花费的目的\n      requestBalance: '',\n      //cost， 花费金额\n      requestAddress: '',\n      //seller, 卖家地址\n      requests: [] //所有的花费请求\n\n    };\n\n    _this.onCardClick = function (seletedFundingDetail) {\n      console.log(\"bbbb :\", seletedFundingDetail);\n\n      _this.setState({\n        seletedFundingDetail: seletedFundingDetail\n      });\n    };\n\n    _this.handleChange = function (e, _ref) {\n      var name = _ref.name,\n          value = _ref.value;\n      return _this.setState(_defineProperty({}, name, value));\n    };\n\n    _this.handleCreateRequest =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var _this$state, creatorFundingDetails, seletedFundingDetail, requestDesc, requestBalance, requestAddress, res;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _this$state = _this.state, creatorFundingDetails = _this$state.creatorFundingDetails, seletedFundingDetail = _this$state.seletedFundingDetail, requestDesc = _this$state.requestDesc, requestBalance = _this$state.requestBalance, requestAddress = _this$state.requestAddress;\n              console.log(requestDesc, requestBalance, requestAddress); //创建花费请求\n              // function createRequest(string _purpose, uint256 _cost, address _seller) onlyManager public {\n\n              _context.prev = 2;\n              console.log(seletedFundingDetail.fundingAddress);\n              _context.next = 6;\n              return createRequest(seletedFundingDetail.fundingAddress, requestDesc, requestBalance, requestAddress);\n\n            case 6:\n              res = _context.sent;\n              console.log(res);\n              _context.next = 13;\n              break;\n\n            case 10:\n              _context.prev = 10;\n              _context.t0 = _context[\"catch\"](2);\n              console.log(_context.t0);\n\n            case 13:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this, [[2, 10]]);\n    }));\n    _this.handleShowRequests =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2() {\n      var fundingAddress, requests;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              fundingAddress = _this.state.seletedFundingDetail.fundingAddress;\n              _context2.prev = 1;\n              _context2.next = 4;\n              return showRequests(fundingAddress);\n\n            case 4:\n              requests = _context2.sent;\n              console.log('requests:', requests);\n\n              _this.setState({\n                requests: requests\n              });\n\n              _context2.next = 12;\n              break;\n\n            case 9:\n              _context2.prev = 9;\n              _context2.t0 = _context2[\"catch\"](1);\n              console.log(_context2.t0);\n\n            case 12:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, this, [[1, 9]]);\n    }));\n\n    _this.handleFinalize =\n    /*#__PURE__*/\n    function () {\n      var _ref4 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3(index) {\n        var address, res;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                console.log('终结请求:', index);\n                address = _this.state.seletedFundingDetail.fundingAddress;\n                _context3.prev = 2;\n                _context3.next = 5;\n                return finalizeRequest(address, index);\n\n              case 5:\n                res = _context3.sent;\n                _context3.next = 11;\n                break;\n\n              case 8:\n                _context3.prev = 8;\n                _context3.t0 = _context3[\"catch\"](2);\n                console.log(_context3.t0);\n\n              case 11:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this, [[2, 8]]);\n      }));\n\n      return function (_x) {\n        return _ref4.apply(this, arguments);\n      };\n    }();\n\n    return _this;\n  }\n\n  _createClass(CreatorFundingTab, [{\n    key: \"componentWillMount\",\n    value: function () {\n      var _componentWillMount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4() {\n        var creatorFundingDetails;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.next = 2;\n                return getFundingDetails(2);\n\n              case 2:\n                creatorFundingDetails = _context4.sent;\n                // console.table(creatorFundingDetails)\n                console.log('xxxx', creatorFundingDetails);\n                this.setState({\n                  creatorFundingDetails: creatorFundingDetails\n                });\n\n              case 5:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function componentWillMount() {\n        return _componentWillMount.apply(this, arguments);\n      }\n\n      return componentWillMount;\n    }() //传递一个回调函数给CardList，将所选择的Card的详细信息返回来\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state2 = this.state,\n          creatorFundingDetails = _this$state2.creatorFundingDetails,\n          seletedFundingDetail = _this$state2.seletedFundingDetail,\n          requestDesc = _this$state2.requestDesc,\n          requestBalance = _this$state2.requestBalance,\n          requestAddress = _this$state2.requestAddress,\n          requests = _this$state2.requests;\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91\n        },\n        __self: this\n      }, React.createElement(CardList, {\n        details: creatorFundingDetails,\n        onCardClick: this.onCardClick,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92\n        },\n        __self: this\n      }), React.createElement(CreateFundingForm, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98\n        },\n        __self: this\n      }, React.createElement(\"h3\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99\n        },\n        __self: this\n      }, \"\\u53D1\\u8D77\\u4ED8\\u6B3E\\u8BF7\\u6C42\"), React.createElement(Segment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101\n        },\n        __self: this\n      }, React.createElement(\"h4\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102\n        },\n        __self: this\n      }, \"\\u5F53\\u524D\\u9879\\u76EE:\", seletedFundingDetail.projectName, \", \\u5730\\u5740: \", seletedFundingDetail.fundingAddress), React.createElement(Form, {\n        onSubmit: this.handleCreateRequest,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103\n        },\n        __self: this\n      }, React.createElement(Form.Input, {\n        type: \"text\",\n        name: \"requestDesc\",\n        required: true,\n        value: requestDesc,\n        label: \"\\u8BF7\\u6C42\\u63CF\\u8FF0\",\n        placeholder: \"\\u8BF7\\u6C42\\u63CF\\u8FF0\",\n        onChange: this.handleChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104\n        },\n        __self: this\n      }), React.createElement(Form.Input, {\n        type: \"text\",\n        name: \"requestBalance\",\n        required: true,\n        value: requestBalance,\n        label: \"\\u4ED8\\u6B3E\\u91D1\\u989D\",\n        labelPosition: \"left\",\n        placeholder: \"\\u4ED8\\u6B3E\\u91D1\\u989D\",\n        onChange: this.handleChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107\n        },\n        __self: this\n      }, React.createElement(Label, {\n        basic: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110\n        },\n        __self: this\n      }, \"\\uFFE5\"), React.createElement(\"input\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111\n        },\n        __self: this\n      })), React.createElement(Form.Input, {\n        type: \"text\",\n        name: \"requestAddress\",\n        required: true,\n        value: requestAddress,\n        label: \"\\u5546\\u5BB6\\u6536\\u6B3E\\u5730\\u5740\",\n        labelPosition: \"left\",\n        placeholder: \"\\u5546\\u5BB6\\u5730\\u5740\",\n        onChange: this.handleChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114\n        },\n        __self: this\n      }, React.createElement(Label, {\n        basic: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        role: \"img\",\n        \"aria-label\": \"location\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117\n        },\n        __self: this\n      }, \"\\uD83D\\uDCCD\")), React.createElement(\"input\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118\n        },\n        __self: this\n      })), React.createElement(Form.Button, {\n        primary: true,\n        content: \"\\u5F00\\u59CB\\u8BF7\\u6C42\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121\n        },\n        __self: this\n      })))), seletedFundingDetail && React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }, React.createElement(Button, {\n        onClick: this.handleShowRequests,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }, \"\\u7533\\u8BF7\\u8BE6\\u60C5\"), React.createElement(RequestTable, {\n        requests: requests,\n        handleFinalize: this.handleFinalize,\n        pageKey: 2,\n        investorCount: seletedFundingDetail.investorCount,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return CreatorFundingTab;\n}(Component);\n\nexport default CreatorFundingTab;","map":{"version":3,"sources":["/Users/janei/Desktop/dapp/crowdfunding/src/display/creatorFundingTab/CreatorFundingTab.js"],"names":["React","Component","createRequest","finalizeRequest","getFundingDetails","showRequests","CardList","CreateFundingForm","Button","Form","Label","Segment","RequestTable","CreatorFundingTab","state","creatorFundingDetails","seletedFundingDetail","requestDesc","requestBalance","requestAddress","requests","onCardClick","console","log","setState","handleChange","e","name","value","handleCreateRequest","fundingAddress","res","handleShowRequests","handleFinalize","index","address","projectName","investorCount"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport {createRequest, finalizeRequest, getFundingDetails, showRequests} from '../../eth/interaction'\nimport CardList from '../common/CardList';\nimport CreateFundingForm from './CreateFundingForm';\nimport {Button, Form, Label, Segment} from 'semantic-ui-react'\nimport RequestTable from \"../common/RequestTable\";\n\nclass CreatorFundingTab extends Component {\n\n    state = {\n        creatorFundingDetails: [],\n        seletedFundingDetail: '',\n        requestDesc: '', //purpose ， 项目方花费的目的\n        requestBalance: '', //cost， 花费金额\n        requestAddress: '', //seller, 卖家地址\n        requests: [], //所有的花费请求\n    }\n\n    async componentWillMount() {\n        //funding地址的数组\n        let creatorFundingDetails = await getFundingDetails(2)\n        // console.table(creatorFundingDetails)\n        console.log('xxxx', creatorFundingDetails)\n\n\n        this.setState({\n            creatorFundingDetails\n        })\n    }\n\n    //传递一个回调函数给CardList，将所选择的Card的详细信息返回来\n    onCardClick = (seletedFundingDetail) => {\n        console.log(\"bbbb :\", seletedFundingDetail)\n\n        this.setState({\n            seletedFundingDetail\n        })\n    }\n\n    //表单数据数据变化时触发\n    handleChange = (e, {name, value}) => this.setState({[name]: value})\n\n    handleCreateRequest = async () => {\n        let {creatorFundingDetails, seletedFundingDetail, requestDesc, requestBalance, requestAddress} = this.state\n        console.log(requestDesc, requestBalance, requestAddress)\n\n        //创建花费请求\n        // function createRequest(string _purpose, uint256 _cost, address _seller) onlyManager public {\n        try {\n            console.log(seletedFundingDetail.fundingAddress);\n            let res = await createRequest(seletedFundingDetail.fundingAddress, requestDesc, requestBalance, requestAddress)\n            console.log(res);\n        } catch (e) {\n            console.log(e)\n        }\n    }\n\n    handleShowRequests = async () => {\n        let fundingAddress = this.state.seletedFundingDetail.fundingAddress\n        try {\n            let requests = await showRequests(fundingAddress)\n            console.log('requests:', requests)\n            this.setState({requests})\n\n        } catch (e) {\n            console.log(e)\n        }\n    }\n\n    handleFinalize = async (index) => {\n        console.log('终结请求:', index)\n\n        let address = this.state.seletedFundingDetail.fundingAddress\n\n        try {\n            let res = await finalizeRequest(address, index)\n        } catch (e) {\n            console.log(e)\n        }\n    }\n\n    render() {\n        let {\n            creatorFundingDetails, seletedFundingDetail,\n            requestDesc, requestBalance, requestAddress,\n            requests,\n\n        } = this.state\n\n        return (\n            <div>\n                <CardList details={creatorFundingDetails}\n                          onCardClick={this.onCardClick}\n                />\n                <CreateFundingForm/>\n\n                {\n                    <div>\n                        <h3>发起付款请求</h3>\n\n                        <Segment>\n                            <h4>当前项目:{seletedFundingDetail.projectName}, 地址: {seletedFundingDetail.fundingAddress}</h4>\n                            <Form onSubmit={this.handleCreateRequest}>\n                                <Form.Input type='text' name='requestDesc' required value={requestDesc}\n                                            label='请求描述' placeholder='请求描述' onChange={this.handleChange}/>\n\n                                <Form.Input type='text' name='requestBalance' required value={requestBalance}\n                                            label='付款金额' labelPosition='left' placeholder='付款金额'\n                                            onChange={this.handleChange}>\n                                    <Label basic>￥</Label>\n                                    <input/>\n                                </Form.Input>\n\n                                <Form.Input type='text' name='requestAddress' required value={requestAddress}\n                                            label='商家收款地址' labelPosition='left' placeholder='商家地址'\n                                            onChange={this.handleChange}>\n                                    <Label basic><span role='img' aria-label='location'>📍</span></Label>\n                                    <input/>\n                                </Form.Input>\n\n                                <Form.Button primary content='开始请求'/>\n                            </Form>\n                        </Segment>\n                    </div>\n                }\n\n                {\n                    seletedFundingDetail && (<div>\n                        <Button onClick={this.handleShowRequests}>申请详情</Button>\n                        <RequestTable requests={requests}\n                                      handleFinalize={this.handleFinalize}\n                                      pageKey={2}\n                                      investorCount={seletedFundingDetail.investorCount}\n                        />\n                    </div>)\n                }\n            </div>\n        )\n    }\n}\n\nexport default CreatorFundingTab\n"]},"metadata":{},"sourceType":"module"}