{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"D:\\\\\\u6D59\\u5927\\u5B66\\u4E60\\u5DE5\\u4F5C\\\\\\u533A\\u5757\\u94FE\\\\iFunding_pass\\\\iFunding_original\\\\src\\\\App.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React from \"react\";\nimport { Row, Col, Layout, Button, Radio, Space, Table, Progress, Modal, Form, Input, InputNumber, DatePicker, Divider, List, message, Spin, Tag, Tooltip, Descriptions } from 'antd';\nimport web3 from './utils/InitWeb3';\nimport fundingInstance from './eth/iFunding';\nconst {\n  Header,\n  Content,\n  Footer\n} = Layout;\nconst {\n  TextArea\n} = Input;\n\nconst truncate = num => Math.floor(100 * num) / 100;\n\nconst openSuccessMessage = text => {\n  message.success(text);\n};\n\nconst openFailureMessage = text => {\n  message.error(text);\n};\n\nconst LaunchForm = props => {\n  _s();\n\n  const [form] = Form.useForm();\n\n  const onFinish = values => {\n    props.onClick(values.name, values.specification, values.amount, values.ddl.unix());\n  };\n\n  const onReset = () => {\n    form.resetFields();\n  };\n\n  return /*#__PURE__*/_jsxDEV(Form, {\n    form: form,\n    name: \"control-hooks\",\n    onFinish: onFinish,\n    children: [/*#__PURE__*/_jsxDEV(Form.Item, {\n      name: \"name\",\n      label: \"\\u7B79\\u6B3E\\u9879\\u76EE\",\n      rules: [{\n        required: true\n      }],\n      children: /*#__PURE__*/_jsxDEV(Input, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 29,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 28,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n      name: \"amount\",\n      label: \"\\u91D1\\u989D\",\n      rules: [{\n        required: true\n      }],\n      children: /*#__PURE__*/_jsxDEV(InputNumber, {\n        min: 1,\n        max: 1000\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 33,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 32,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n      name: \"ddl\",\n      label: \"\\u622A\\u81F3\\u65E5\\u671F\",\n      rules: [{\n        required: true\n      }],\n      children: /*#__PURE__*/_jsxDEV(DatePicker, {\n        type: \"date\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 37,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 36,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n      name: \"specification\",\n      label: \"\\u9879\\u76EE\\u63CF\\u8FF0\",\n      rules: [{\n        required: true\n      }],\n      children: /*#__PURE__*/_jsxDEV(Input, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 41,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n      children: /*#__PURE__*/_jsxDEV(Space, {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          type: \"primary\",\n          htmlType: \"submit\",\n          children: \"\\u53D1\\u5E03\\u7B79\\u6B3E\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 46,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          type: \"danger\",\n          htmlType: \"button\",\n          onClick: onReset,\n          children: \"\\u6E05\\u7A7A\\u8F93\\u5165\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 49,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 45,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 27,\n    columnNumber: 7\n  }, this);\n};\n\n_s(LaunchForm, \"rI7DrJIrFu7YmlGWYiMFTzs8jF0=\", false, function () {\n  return [Form.useForm];\n});\n\n_c = LaunchForm;\n\nconst RequestForm = props => {\n  _s2();\n\n  const [form] = Form.useForm();\n\n  const onFinish = values => {\n    props.onClick(props.idx, values.description, values.amount);\n  };\n\n  const onReset = () => {\n    form.resetFields();\n  };\n\n  return /*#__PURE__*/_jsxDEV(Form, {\n    form: form,\n    name: \"control-hooks\",\n    onFinish: onFinish,\n    children: [/*#__PURE__*/_jsxDEV(Form.Item, {\n      name: \"amount\",\n      label: \"\\u4F7F\\u7528\\u6570\\u76EE\",\n      rules: [{\n        required: true\n      }],\n      children: /*#__PURE__*/_jsxDEV(InputNumber, {\n        min: 1,\n        max: props.leftAmount\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n      name: \"description\",\n      label: \"\\u7528\\u9014\\u8BF4\\u660E\",\n      rules: [{\n        required: true\n      }],\n      children: /*#__PURE__*/_jsxDEV(Input, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n      children: /*#__PURE__*/_jsxDEV(Space, {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          type: \"primary\",\n          htmlType: \"submit\",\n          children: \"\\u7533\\u8BF7\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          type: \"danger\",\n          htmlType: \"button\",\n          onClick: onReset,\n          children: \"\\u6E05\\u7A7A\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 70,\n    columnNumber: 7\n  }, this);\n};\n\n_s2(RequestForm, \"rI7DrJIrFu7YmlGWYiMFTzs8jF0=\", false, function () {\n  return [Form.useForm];\n});\n\n_c2 = RequestForm;\n\nconst InfoDescript = props => {\n  const status = props.isOutdated ? /*#__PURE__*/_jsxDEV(Tag, {\n    color: \"magenta\",\n    children: \"\\u5DF2\\u8FC7\\u671F\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 89,\n    columnNumber: 35\n  }, this) : props.currentAmount === props.totalAmount ? /*#__PURE__*/_jsxDEV(Tag, {\n    color: \"success\",\n    children: \"\\u5DF2\\u5B8C\\u6210\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 89,\n    columnNumber: 107\n  }, this) : /*#__PURE__*/_jsxDEV(Tag, {\n    color: \"processing\",\n    children: \"\\u8FDB\\u884C\\u4E2D\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 89,\n    columnNumber: 138\n  }, this);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"\\u672C\\u7B79\\u6B3E\\u9879\\u4FE1\\u606F\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Descriptions, {\n      column: 1,\n      children: [/*#__PURE__*/_jsxDEV(Descriptions.Item, {\n        label: \"\\u7B79\\u6B3E\\u9879\",\n        children: [props.name, \" \", status]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Descriptions.Item, {\n        label: \"\\u7B79\\u6B3E\\u91D1\\u989D\",\n        children: props.totalAmount\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Descriptions.Item, {\n        label: \"\\u53D1\\u8D77\\u4EBA\",\n        children: props.launcher\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Descriptions.Item, {\n        label: \"\\u622A\\u81F3\\u65E5\\u671F\",\n        children: new Date(props.deadline * 1000).toLocaleDateString()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Descriptions.Item, {\n        label: \"\\u7B79\\u6B3E\\u7B80\\u4ECB\",\n        children: props.description\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Descriptions.Item, {\n        label: \"\\u5DF2\\u7B79\\u6B3E\",\n        children: [props.currentAmount, \" ETH\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Descriptions.Item, {\n        label: \"\\u6211\\u7684\\u6295\\u8D44\",\n        children: [props.investAmount, \" ETH\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n\n_c3 = InfoDescript;\n\nclass InvestDisplay extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      amount: 1\n    };\n  }\n\n  render() {\n    const leftAmount = this.props.amount - this.props.currentAmount;\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"\\u6211\\u8981\\u6295\\u8D44\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Form, {\n        name: \"control-hooks\",\n        children: [/*#__PURE__*/_jsxDEV(Form.Item, {\n          name: \"value\",\n          label: \"\\u6295\\u8D44\\u6570\\u989D\",\n          rules: [{\n            required: true\n          }],\n          children: /*#__PURE__*/_jsxDEV(InputNumber, {\n            min: 1,\n            max: leftAmount,\n            defaultValue: 1,\n            onChange: value => {\n              this.setState({\n                amount: value\n              });\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n          children: /*#__PURE__*/_jsxDEV(Space, {\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              type: \"primary\",\n              onClick: () => this.props.invest(this.props.idx, this.state.amount),\n              children: \"\\u786E\\u5B9A\\u6295\\u8D44\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 123,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Divider, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true);\n  }\n\n}\n\n;\n/*\nclass VoteDisplay extends React.Component{\n    render(){\n      const invested = () => (parseInt(this.props.investAmount) !== 0)\n      const approved = (item) => (parseInt(item.approveVotes) >= parseInt(this.props.totalAmount)/2)\n      const disapproved = (item) => (parseInt(item.disapproveVotes) > parseInt(this.props.totalAmount)/2)\n      const finished = (item) => (approved(item) || disapproved(item))\n      const status = (item) => (approved(item) ? <Tag color=\"success\">通过</Tag> :(disapproved(item) ?<Tag color=\"magenta\">否决</Tag> :<Tag color=\"processing\">进行中</Tag>))\n  \n      const Buttons = (item) => [\n        <Button onClick={() => {this.props.vote(this.props.idx, item.idx, true)}}>允许</Button>,\n        <Button onClick={() => {this.props.vote(this.props.idx, item.idx, false)}}>拒绝</Button>\n        ]\n      const shownButtons = (item) =>  Buttons(item)\n      \n      const leftVotes = (item) => (parseInt(this.props.totalAmount) - parseInt(item.approveVotes) - parseInt(item.disapproveVotes))\n      const shownText = (item) => `${item.purpose}:  ETH(${item.approveVotes}/${this.props.totalAmount})`\n      return(\n        <>\n          <Divider></Divider>\n          <h1>投资人投票</h1>\n          <List\n            bordered\n            dataSource={this.props.requests}\n            renderItem={item => (\n              <List.Item actions={!finished(item) && invested && shownButtons(item)}>\n                  {shownText(item)}{status(item)}\n              </List.Item>\n            )}\n          />\n          <Divider></Divider>\n        </>\n      )\n  }\n}*/\n\nclass VoteDisplay extends React.Component {\n  render() {\n    const invested = () => parseInt(this.props.investAmount) !== 0;\n\n    const approved = item => parseInt(item.approveVotes) > parseInt(this.props.totalAmount) / 2;\n\n    const disapproved = item => parseInt(item.disapproveVotes) > parseInt(this.props.totalAmount) / 2;\n\n    const finished = item => approved(item) || disapproved(item);\n\n    const tag = item => approved(item) ? /*#__PURE__*/_jsxDEV(Tag, {\n      color: \"success\",\n      children: \"\\u901A\\u8FC7\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 9\n    }, this) : disapproved(item) ? /*#__PURE__*/_jsxDEV(Tag, {\n      color: \"error\",\n      children: \"\\u5426\\u51B3\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 11\n    }, this) : /*#__PURE__*/_jsxDEV(Tag, {\n      color: \"processing\",\n      children: \"\\u8FDB\\u884C\\u4E2D\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 11\n    }, this);\n\n    const votedText = \"您已投过票了，无法再投\";\n\n    const votedButtons = () => [/*#__PURE__*/_jsxDEV(Tooltip, {\n      placement: \"top\",\n      title: votedText,\n      children: /*#__PURE__*/_jsxDEV(Button, {\n        disabled: true,\n        children: \"\\u540C\\u610F\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Tooltip, {\n      placement: \"top\",\n      title: votedText,\n      children: /*#__PURE__*/_jsxDEV(Button, {\n        disabled: true,\n        children: \"\\u53CD\\u5BF9\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 9\n    }, this)];\n\n    const nonVotedButtons = item => [/*#__PURE__*/_jsxDEV(Button, {\n      onClick: () => {\n        this.props.vote(this.props.idx, item.idx, true);\n      },\n      children: \"\\u540C\\u610F\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Button, {\n      onClick: () => {\n        this.props.vote(this.props.idx, item.idx, false);\n      },\n      children: \"\\u53CD\\u5BF9\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 9\n    }, this)];\n\n    const shownButtons = item => this.props.isVoted ? votedButtons() : nonVotedButtons(item);\n\n    const leftVotes = item => parseInt(this.props.totalAmount) - parseInt(item.approveVotes) - parseInt(item.disapproveVotes);\n\n    const shownText = item => `${item.purpose}: ${item.totalAmount} ETH(${item.approveVotes}/${item.disapproveVotes}/${leftVotes(item)})`;\n\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Divider, {\n        orientation: \"left\",\n        children: \"\\u8D44\\u91D1\\u8BF7\\u6C42\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: `资金请求需由50%的票数批准才可通过，您的票数:${this.props.investAmount}`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\u62EC\\u53F7\\u5185\\u4E3A(\\u8D5E\\u6210/\\u53CD\\u5BF9/\\u672A\\u6295)\\u7684\\u7968\\u6570\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(List, {\n        bordered: true,\n        dataSource: this.props.requests,\n        renderItem: item => /*#__PURE__*/_jsxDEV(List.Item, {\n          actions: !finished(item) && invested && shownButtons(item),\n          children: [shownText(item), tag(item)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true);\n  }\n\n}\n\nclass CreateRequestDisplay extends React.Component {\n  render() {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Divider, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"\\u8BF7\\u6C42\\u8D44\\u91D1\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(RequestForm, { ...this.props,\n        onClick: this.props.request\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true);\n  }\n\n}\n\nclass DetailPage extends React.Component {\n  render() {\n    const isSelf = this.props.launcher === this.props.currentAccount;\n    const isOutdated = this.props.deadline * 1000 < new Date().getTime();\n    const finished = this.props.currentAmount === this.props.totalAmount;\n    const showInvestDisplay = !isOutdated && !finished;\n    const showCreateRequestDisplay = !isOutdated && isSelf && finished;\n    const showVoteDisplay = !isOutdated && finished && (isSelf || parseInt(this.props.investAmount) !== 0);\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(InfoDescript, { ...this.props,\n        isOutdated: isOutdated\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 9\n      }, this), showInvestDisplay && /*#__PURE__*/_jsxDEV(InvestDisplay, { ...this.props\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 31\n      }, this), showCreateRequestDisplay && /*#__PURE__*/_jsxDEV(CreateRequestDisplay, { ...this.props\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 38\n      }, this), showVoteDisplay && /*#__PURE__*/_jsxDEV(VoteDisplay, { ...this.props\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 29\n      }, this)]\n    }, void 0, true);\n  }\n\n}\n\nexport default class App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      currentAccount: '陌生人',\n      rawData: [],\n      shownData: [],\n      isLaunchVisible: false,\n      isDetailVisible: false,\n      columns: [{\n        title: ' ',\n        key: 'progress-money',\n        render: (text, record) => /*#__PURE__*/_jsxDEV(Progress, {\n          percent: truncate(100 * record.currentAmount / record.totalAmount)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 15\n        }, this)\n      }, {\n        title: '',\n        key: 'detail',\n        render: (text, record) => /*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => this.openDetailView(record.key),\n          children: \"\\u70B9\\u51FB\\u67E5\\u770B\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 269,\n          columnNumber: 15\n        }, this)\n      }, {\n        title: '筹款项目',\n        dataIndex: 'name',\n        key: 'name'\n      }, {\n        title: '筹款金额',\n        dataIndex: 'totalAmount',\n        key: 'totalAmount'\n      }, {\n        title: '发起者',\n        dataIndex: 'launcher',\n        key: 'launcher'\n      }],\n      detail: {},\n      requests: [],\n      loading: true\n    };\n    this.openDetailView = this.openDetailView.bind(this);\n    this.changeShownData = this.changeShownData.bind(this);\n    this.launch = this.launch.bind(this);\n    this.invest = this.invest.bind(this);\n    this.request = this.request.bind(this);\n    this.vote = this.vote.bind(this);\n  }\n\n  async componentDidMount() {\n    let accounts = await web3.eth.getAccounts();\n    let counts = await fundingInstance.methods.getFundingsCount().call();\n    let rawData = [];\n\n    for (let i = 0; i < counts; i++) {\n      let key = i;\n      let name = await fundingInstance.methods.getFundingName(i).call();\n      let address = await fundingInstance.methods.getFundingAddress(i).call();\n      let launcher = await fundingInstance.methods.getFundingLauncher(i).call();\n      let currentAmountWei = await fundingInstance.methods.getFundingCurrentAmount(i).call();\n      let currentAmount = web3.utils.fromWei(currentAmountWei, 'ether');\n      let totalAmountWei = await fundingInstance.methods.getFundingTotalAmount(i).call();\n      let totalAmount = web3.utils.fromWei(totalAmountWei, 'ether');\n      let leftAmountWei = await fundingInstance.methods.getFundingLeftAmount(i).call();\n      let leftAmount = web3.utils.fromWei(leftAmountWei, 'ether');\n      let deadline = await fundingInstance.methods.getFundingDeadline(i).call();\n      let description = await fundingInstance.methods.getFundingDescription(i).call();\n      let investAmountWei = await fundingInstance.methods.getFundingInvestment(i, accounts[0]).call();\n      let investAmount = web3.utils.fromWei(investAmountWei, 'ether');\n      rawData.push({\n        key: key,\n        idx: key,\n        name: name,\n        address: address,\n        launcher: launcher,\n        currentAmount: currentAmount,\n        totalAmount: totalAmount,\n        leftAmount: leftAmount,\n        deadline: deadline,\n        description: description,\n        investAmount: investAmount\n      });\n    }\n\n    this.setState({\n      currentAccount: accounts[0],\n      rawData: rawData,\n      shownData: rawData,\n      loading: false\n    });\n  }\n\n  async launch(name, description, totalAmount, deadline) {\n    const currentAccount = this.state.currentAccount;\n    let totalAmountWei = web3.utils.toWei(totalAmount.toString(), 'ether');\n\n    try {\n      await fundingInstance.methods.launch(name, description, totalAmountWei, deadline).send({\n        from: currentAccount,\n        gas: '3000000'\n      });\n      openSuccessMessage(\"筹款发布成功\");\n      window.location.reload();\n    } catch (e) {\n      openFailureMessage(\"筹款发布失败\");\n      console.log(e);\n    }\n  }\n\n  async invest(key, amount) {\n    const currentAccount = this.state.currentAccount;\n\n    try {\n      await fundingInstance.methods.invest(key).send({\n        from: currentAccount,\n        value: web3.utils.toWei(amount.toString(), 'ether'),\n        gas: '3000000'\n      });\n      openSuccessMessage(\"投资成功\");\n      window.location.reload();\n    } catch (e) {\n      console.log(e);\n      openFailureMessage(\"投资失败\");\n    }\n  }\n\n  async request(key, purpose, amount) {\n    const amountWei = web3.utils.toWei(amount.toString(), 'ether');\n    const currentAccount = this.state.currentAccount;\n\n    try {\n      await fundingInstance.methods.request(key, purpose, amountWei).send({\n        from: currentAccount,\n        gas: '3000000'\n      });\n      openSuccessMessage(\"请求成功\");\n      window.location.reload();\n    } catch (e) {\n      console.log(e);\n      openFailureMessage(\"请求失败\");\n    }\n  }\n\n  async vote(i, j, approve) {\n    const currentAccount = this.state.currentAccount;\n\n    try {\n      await fundingInstance.methods.vote(i, j, approve).send({\n        from: currentAccount,\n        gas: '3000000'\n      });\n      openSuccessMessage(\"投票成功\");\n      window.location.reload();\n    } catch (e) {\n      console.log(e);\n      openFailureMessage(\"投票失败\");\n    }\n  }\n\n  async openDetailView(key) {\n    let counts = await fundingInstance.methods.getFundingRequestCount(key).call();\n    let requests = [];\n\n    for (let j = 0; j < counts; j++) {\n      let purpose = await fundingInstance.methods.getFundingRequestPurpose(key, j).call();\n      let approveVotesWei = await fundingInstance.methods.getFundingRequestApproveVotes(key, j).call();\n      let approveVotes = web3.utils.fromWei(approveVotesWei.toString(), 'ether');\n      let disapproveVotesWei = await fundingInstance.methods.getFundingRequestDisapproveVotes(key, j).call();\n      let disapproveVotes = web3.utils.fromWei(disapproveVotesWei.toString(), 'ether');\n      let totalAmountWei = await fundingInstance.methods.getFundingRequestTotalAmount(key, j).call();\n      let totalAmount = web3.utils.fromWei(totalAmountWei.toString(), 'ether');\n      let isVoted = await fundingInstance.methods.getFundingRequestIsVoted(key, j).call();\n      requests.push({\n        idx: j,\n        purpose: purpose,\n        approveVotes: approveVotes,\n        disapproveVotes: disapproveVotes,\n        totalAmount: totalAmount,\n        isVoted: isVoted\n      });\n    }\n\n    this.setState(state => ({\n      detail: state.rawData[key],\n      requests: requests\n    }));\n    this.setState({\n      isDetailVisible: true\n    });\n  }\n\n  changeShownData(tag) {\n    const rawData = this.state.rawData;\n    const currentAccount = this.state.currentAccount;\n\n    if (tag === \"all\") {\n      this.setState({\n        shownData: rawData\n      });\n    } else if (tag === \"myLaunch\") {\n      this.setState({\n        shownData: rawData.filter(item => item.launcher === currentAccount)\n      });\n    } else if (tag === \"myInvest\") {\n      this.setState({\n        shownData: rawData.filter(item => parseInt(item.investAmount) !== 0)\n      });\n    } else if (tag === \"Unfinished\") {\n      this.setState({\n        shownData: rawData.filter(item => item.currentAmount !== item.totalAmount)\n      });\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(Layout, {\n      className: \"layout\",\n      style: {\n        height: \"100vh\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(Header, {\n        children: /*#__PURE__*/_jsxDEV(Row, {\n          children: [/*#__PURE__*/_jsxDEV(Col, {\n            span: 2,\n            style: {\n              margin: \"auto\"\n            },\n            children: /*#__PURE__*/_jsxDEV(\"font\", {\n              color: \"white\",\n              children: this.state.currentAccount\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 451,\n              columnNumber: 52\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 451,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Col, {\n            span: 6\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 452,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Col, {\n            span: 6\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 453,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Col, {\n            span: 6\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 454,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Col, {\n            span: 2\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 455,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 450,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 449,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Content, {\n        style: {\n          overflow: \"auto\",\n          padding: \"20px 20px\"\n        },\n        children: /*#__PURE__*/_jsxDEV(Spin, {\n          spinning: this.state.loading,\n          size: \"large\",\n          children: [/*#__PURE__*/_jsxDEV(Modal, {\n            title: \"\\u53D1\\u5E03\\u7B79\\u8D44\",\n            visible: this.state.isLaunchVisible,\n            footer: null,\n            onCancel: () => {\n              this.setState({\n                isLaunchVisible: false\n              });\n            },\n            children: /*#__PURE__*/_jsxDEV(LaunchForm, {\n              onClick: this.launch\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 466,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 460,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Modal, {\n            title: \"\\u8BE6\\u60C5\\u548C\\u64CD\\u4F5C\",\n            visible: this.state.isDetailVisible,\n            footer: null,\n            width: \"600px\",\n            onCancel: () => {\n              this.setState({\n                isDetailVisible: false\n              });\n            },\n            children: /*#__PURE__*/_jsxDEV(DetailPage, { ...this.state.detail,\n              requests: this.state.requests,\n              invest: this.invest,\n              request: this.request,\n              vote: this.vote,\n              currentAccount: this.state.currentAccount\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 475,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 468,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Radio.Group, {\n            size: \"large\",\n            onChange: e => this.changeShownData(e.target.value),\n            defaultValue: \"\\u6240\\u6709\\u9879\\u76EE\",\n            children: [/*#__PURE__*/_jsxDEV(Radio.Button, {\n              value: \"all\",\n              children: \"\\u6240\\u6709\\u9879\\u76EE\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 486,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Radio.Button, {\n              value: \"myLaunch\",\n              children: \"\\u6211\\u53D1\\u8D77\\u7684\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 487,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Radio.Button, {\n              value: \"myInvest\",\n              children: \"\\u6211\\u6295\\u8D44\\u7684\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 488,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Radio.Button, {\n              value: \"Unfinished\",\n              children: \"\\u672A\\u5B8C\\u6210\\u7684\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 489,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              size: \"large\",\n              type: \"link\",\n              style: {\n                visibility: this.state.loading ? \"hidden\" : \"visible\"\n              },\n              onClick: () => this.setState({\n                isLaunchVisible: true\n              }),\n              children: \"\\u53D1\\u5E03\\u7B79\\u8D44\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 490,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 485,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Table, {\n            columns: this.state.columns,\n            dataSource: this.state.shownData,\n            pagination: {\n              pageSize: 8\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 492,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 459,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 458,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Footer, {\n        style: {\n          backgroundColor: \"rgba(0, 0, 0, 0.85)\",\n          color: \"white\",\n          textAlign: 'center'\n        },\n        children: \"Funding \\xA92021 Created by byr\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 495,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 448,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n;\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"LaunchForm\");\n$RefreshReg$(_c2, \"RequestForm\");\n$RefreshReg$(_c3, \"InfoDescript\");","map":{"version":3,"sources":["D:/浙大学习工作/区块链/iFunding_pass/iFunding_original/src/App.js"],"names":["React","Row","Col","Layout","Button","Radio","Space","Table","Progress","Modal","Form","Input","InputNumber","DatePicker","Divider","List","message","Spin","Tag","Tooltip","Descriptions","web3","fundingInstance","Header","Content","Footer","TextArea","truncate","num","Math","floor","openSuccessMessage","text","success","openFailureMessage","error","LaunchForm","props","form","useForm","onFinish","values","onClick","name","specification","amount","ddl","unix","onReset","resetFields","required","RequestForm","idx","description","leftAmount","InfoDescript","status","isOutdated","currentAmount","totalAmount","launcher","Date","deadline","toLocaleDateString","investAmount","InvestDisplay","Component","constructor","state","render","value","setState","invest","VoteDisplay","invested","parseInt","approved","item","approveVotes","disapproved","disapproveVotes","finished","tag","votedText","votedButtons","nonVotedButtons","vote","shownButtons","isVoted","leftVotes","shownText","purpose","requests","CreateRequestDisplay","request","DetailPage","isSelf","currentAccount","getTime","showInvestDisplay","showCreateRequestDisplay","showVoteDisplay","App","rawData","shownData","isLaunchVisible","isDetailVisible","columns","title","key","record","openDetailView","dataIndex","detail","loading","bind","changeShownData","launch","componentDidMount","accounts","eth","getAccounts","counts","methods","getFundingsCount","call","i","getFundingName","address","getFundingAddress","getFundingLauncher","currentAmountWei","getFundingCurrentAmount","utils","fromWei","totalAmountWei","getFundingTotalAmount","leftAmountWei","getFundingLeftAmount","getFundingDeadline","getFundingDescription","investAmountWei","getFundingInvestment","push","toWei","toString","send","from","gas","window","location","reload","e","console","log","amountWei","j","approve","getFundingRequestCount","getFundingRequestPurpose","approveVotesWei","getFundingRequestApproveVotes","disapproveVotesWei","getFundingRequestDisapproveVotes","getFundingRequestTotalAmount","getFundingRequestIsVoted","filter","height","margin","overflow","padding","target","visibility","pageSize","backgroundColor","color","textAlign"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { Row, Col, Layout, Button, Radio, Space, Table, Progress, Modal, Form, Input, InputNumber, DatePicker, Divider, List, message, Spin, Tag, Tooltip, Descriptions } from 'antd';\nimport web3 from './utils/InitWeb3';\nimport fundingInstance from './eth/iFunding';\nconst { Header, Content, Footer } = Layout;\nconst { TextArea } = Input;\n\nconst truncate = (num) => Math.floor(100*num)/100\nconst openSuccessMessage = (text) => {\n  message.success(text);\n}\nconst openFailureMessage = (text) => {\n  message.error(text);\n}\n\nconst LaunchForm = (props) => {\n    const [form] = Form.useForm();\n    const onFinish = (values) => {\n        props.onClick(values.name, values.specification, values.amount, values.ddl.unix())\n    };\n    \n    const onReset = () => {\n      form.resetFields();\n    };\n  \n    return (\n      <Form form={form} name=\"control-hooks\" onFinish={onFinish}>\n        <Form.Item name=\"name\" label=\"筹款项目\" rules={[{ required: true }]}>\n          <Input />\n        </Form.Item>\n\n        <Form.Item name=\"amount\" label=\"金额\" rules={[{ required: true }]}>\n          <InputNumber min={1} max={1000}/>\n        </Form.Item>\n\n        <Form.Item name=\"ddl\" label=\"截至日期\" rules={[{ required: true }]}>\n          <DatePicker type=\"date\" />\n        </Form.Item>\n\n        <Form.Item name=\"specification\" label=\"项目描述\" rules={[{ required: true }]}>\n          <Input />\n        </Form.Item>\n\n        <Form.Item>\n          <Space>\n            <Button type=\"primary\" htmlType=\"submit\">\n              发布筹款\n            </Button>\n            <Button type=\"danger\" htmlType=\"button\" onClick={onReset}>\n              清空输入\n            </Button>\n          </Space>\n        </Form.Item>\n      </Form>\n    );\n  };\n\nconst RequestForm = (props) => {\n    const [form] = Form.useForm();\n\n    const onFinish = (values) => {\n        props.onClick(props.idx, values.description, values.amount)\n    };\n\n    const onReset = () => {\n        form.resetFields();\n    };\n\n    return(\n      <Form form={form} name=\"control-hooks\" onFinish={onFinish}> \n        <Form.Item  name=\"amount\" label=\"使用数目\" rules={[{required: true}]}>\n          <InputNumber min={1} max={props.leftAmount}/>\n        </Form.Item>\n        <Form.Item  name=\"description\" label=\"用途说明\" rules={[{required: true}]}>\n          <Input />\n        </Form.Item>\n        <Form.Item>\n          <Space>\n            <Button type=\"primary\" htmlType=\"submit\">申请</Button>\n            <Button type=\"danger\" htmlType=\"button\" onClick={onReset}>清空</Button>\n          </Space>\n        </Form.Item>\n      </Form>\n\n  );\n};\n\nconst InfoDescript = (props) => {\n    const status=props.isOutdated?<Tag color=\"magenta\">已过期</Tag>:(props.currentAmount===props.totalAmount?<Tag color=\"success\">已完成</Tag>:<Tag color=\"processing\">进行中</Tag>)\n\n  return(\n    <>\n      <h1>本筹款项信息</h1>\n      <Descriptions column={1}>\n        <Descriptions.Item label=\"筹款项\">{props.name} {status}</Descriptions.Item>\n        <Descriptions.Item label=\"筹款金额\">{props.totalAmount}</Descriptions.Item>\n        <Descriptions.Item label=\"发起人\">{props.launcher}</Descriptions.Item>\n        <Descriptions.Item label=\"截至日期\">{(new Date(props.deadline * 1000)).toLocaleDateString()}</Descriptions.Item>\n        <Descriptions.Item label=\"筹款简介\">{props.description}</Descriptions.Item>\n        <Descriptions.Item label=\"已筹款\">{props.currentAmount} ETH</Descriptions.Item>\n        <Descriptions.Item label=\"我的投资\">{props.investAmount} ETH</Descriptions.Item>\n      </Descriptions>\n\n    </>\n  );\n};\nclass InvestDisplay extends React.Component{\n    constructor(props){\n      super(props);\n      this.state={amount:1}\n      }   \n    render(){\n      const leftAmount=this.props.amount-this.props.currentAmount;\n      return(\n        <>\n          <h1>我要投资</h1>\n          <Form  name=\"control-hooks\" >\n            <Form.Item  name=\"value\" label=\"投资数额\" rules={[{required: true}]}>\n              <InputNumber min={1} max={leftAmount} defaultValue={1} onChange={(value) => {this.setState({amount: value})}}/>\n            </Form.Item>\n            <Form.Item>\n              <Space>\n                <Button type=\"primary\" onClick={() => this.props.invest(this.props.idx, this.state.amount)}>确定投资</Button>\n              </Space>\n            </Form.Item>\n          </Form>\n          <Divider></Divider>\n        </>  \n      )\n                }\n  };\n/*\nclass VoteDisplay extends React.Component{\n    render(){\n      const invested = () => (parseInt(this.props.investAmount) !== 0)\n      const approved = (item) => (parseInt(item.approveVotes) >= parseInt(this.props.totalAmount)/2)\n      const disapproved = (item) => (parseInt(item.disapproveVotes) > parseInt(this.props.totalAmount)/2)\n      const finished = (item) => (approved(item) || disapproved(item))\n      const status = (item) => (approved(item) ? <Tag color=\"success\">通过</Tag> :(disapproved(item) ?<Tag color=\"magenta\">否决</Tag> :<Tag color=\"processing\">进行中</Tag>))\n  \n      const Buttons = (item) => [\n        <Button onClick={() => {this.props.vote(this.props.idx, item.idx, true)}}>允许</Button>,\n        <Button onClick={() => {this.props.vote(this.props.idx, item.idx, false)}}>拒绝</Button>\n        ]\n      const shownButtons = (item) =>  Buttons(item)\n      \n      const leftVotes = (item) => (parseInt(this.props.totalAmount) - parseInt(item.approveVotes) - parseInt(item.disapproveVotes))\n      const shownText = (item) => `${item.purpose}:  ETH(${item.approveVotes}/${this.props.totalAmount})`\n      return(\n        <>\n          <Divider></Divider>\n          <h1>投资人投票</h1>\n          <List\n            bordered\n            dataSource={this.props.requests}\n            renderItem={item => (\n              <List.Item actions={!finished(item) && invested && shownButtons(item)}>\n                  {shownText(item)}{status(item)}\n              </List.Item>\n            )}\n          />\n          <Divider></Divider>\n        </>\n      )\n  }\n}*/\nclass VoteDisplay extends React.Component {\n    render() {\n      const invested = () => (parseInt(this.props.investAmount) !== 0)\n      const approved = (item) => (parseInt(item.approveVotes) > parseInt(this.props.totalAmount)/2)\n      const disapproved = (item) => (parseInt(item.disapproveVotes) > parseInt(this.props.totalAmount)/2)\n      const finished = (item) => (approved(item) || disapproved(item))\n      const tag = (item) => (approved(item) ? \n        <Tag color=\"success\">通过</Tag> :\n        (disapproved(item) ?\n          <Tag color=\"error\">否决</Tag> :\n          <Tag color=\"processing\">进行中</Tag>\n        )\n      )\n  \n      const votedText = \"您已投过票了，无法再投\"\n      const votedButtons = () => [\n        <Tooltip placement=\"top\" title={votedText}>\n          <Button disabled>同意</Button>\n        </Tooltip>,\n        <Tooltip placement=\"top\" title={votedText}>\n        <Button disabled>反对</Button>\n      </Tooltip>\n      ]\n      const nonVotedButtons = (item) => [\n        <Button onClick={() => {this.props.vote(this.props.idx, item.idx, true)}}>同意</Button>,\n        <Button onClick={() => {this.props.vote(this.props.idx, item.idx, false)}}>反对</Button>\n      ]\n      const shownButtons = (item) => this.props.isVoted ? votedButtons() : nonVotedButtons(item)\n      \n      const leftVotes = (item) => (parseInt(this.props.totalAmount) - parseInt(item.approveVotes) - parseInt(item.disapproveVotes))\n      const shownText = (item) => `${item.purpose}: ${item.totalAmount} ETH(${item.approveVotes}/${item.disapproveVotes}/${leftVotes(item)})`\n  \n      return (\n        <>\n          <Divider orientation=\"left\">资金请求</Divider>\n          <p>{`资金请求需由50%的票数批准才可通过，您的票数:${this.props.investAmount}`}</p>\n          <p>括号内为(赞成/反对/未投)的票数</p>\n          <List\n            bordered\n            dataSource={this.props.requests}\n            renderItem={item => (\n              <List.Item actions={!finished(item) && invested && shownButtons(item)}>\n                {shownText(item)}{tag(item)}\n              </List.Item>\n            )}\n          />\n        </>\n      )\n    }\n  }\n\nclass CreateRequestDisplay extends React.Component {\n    render() {\n      return (\n        <>\n          <Divider></Divider>\n          <h1>请求资金</h1>\n          <RequestForm {...this.props} onClick={this.props.request} />\n        </>\n      )\n          }\n}\nclass DetailPage extends React.Component {\n  render() {\n    const isSelf = (this.props.launcher === this.props.currentAccount)\n    const isOutdated = (this.props.deadline*1000 < (new Date()).getTime())\n    const finished = (this.props.currentAmount === this.props.totalAmount)\n    const showInvestDisplay = (!isOutdated) && (!finished);\n    const showCreateRequestDisplay = (!isOutdated) && (isSelf) && (finished);\n    const showVoteDisplay = (!isOutdated) && (finished) && ((isSelf)||(parseInt(this.props.investAmount) !== 0));\n    return (\n      <>\n        <InfoDescript {...this.props} isOutdated={isOutdated} />\n        {showInvestDisplay && <InvestDisplay {...this.props}/>}\n        {showCreateRequestDisplay && <CreateRequestDisplay {...this.props}/>}\n        {showVoteDisplay && <VoteDisplay {...this.props}/>}\n      </>\n    )\n  }\n}\n\nexport default class App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      currentAccount: '陌生人',\n      rawData: [],\n      shownData: [],\n      isLaunchVisible: false,\n      isDetailVisible: false,\n      columns: [\n        {\n            title: ' ',\n            key: 'progress-money',\n            render: (text, record) => (\n              <Progress percent={truncate(100*record.currentAmount/record.totalAmount)}></Progress>\n            )\n        },\n        {\n            title: '',\n            key: 'detail',\n            render: (text, record) => (\n              <Button onClick={() => this.openDetailView(record.key)}>点击查看</Button>\n            ),\n          },\n        {\n          title: '筹款项目',\n          dataIndex: 'name',\n          key: 'name',\n        },\n        {\n          title: '筹款金额',\n          dataIndex: 'totalAmount',\n          key: 'totalAmount',\n          },\n        {\n          title: '发起者',\n          dataIndex: 'launcher',\n          key: 'launcher',\n        }\n      ],\n      detail: {},\n      requests: [],\n      loading: true,\n    }\n    this.openDetailView = this.openDetailView.bind(this)\n    this.changeShownData = this.changeShownData.bind(this)\n    this.launch = this.launch.bind(this)\n    this.invest = this.invest.bind(this)\n    this.request = this.request.bind(this)\n    this.vote = this.vote.bind(this)\n  }\n\n  async componentDidMount() {\n    let accounts = await web3.eth.getAccounts()\n    let counts = await fundingInstance.methods.getFundingsCount().call()\n    let rawData = []\n    for(let i = 0;i < counts;i++) {\n      let key = i;\n      let name = await fundingInstance.methods.getFundingName(i).call()\n      let address = await fundingInstance.methods.getFundingAddress(i).call()\n      let launcher = await fundingInstance.methods.getFundingLauncher(i).call()\n      let currentAmountWei = await fundingInstance.methods.getFundingCurrentAmount(i).call()\n      let currentAmount = web3.utils.fromWei(currentAmountWei, 'ether');\n      let totalAmountWei = await fundingInstance.methods.getFundingTotalAmount(i).call()\n      let totalAmount = web3.utils.fromWei(totalAmountWei, 'ether');\n      let leftAmountWei = await fundingInstance.methods.getFundingLeftAmount(i).call()\n      let leftAmount = web3.utils.fromWei(leftAmountWei, 'ether')\n      let deadline = await fundingInstance.methods.getFundingDeadline(i).call()\n      let description = await fundingInstance.methods.getFundingDescription(i).call()\n      let investAmountWei = await fundingInstance.methods.getFundingInvestment(i, accounts[0]).call()\n      let investAmount = web3.utils.fromWei(investAmountWei, 'ether')\n      rawData.push({\n        key: key,\n        idx: key,\n        name: name,\n        address: address,\n        launcher: launcher,\n        currentAmount: currentAmount,\n        totalAmount: totalAmount,\n        leftAmount: leftAmount,\n        deadline: deadline,\n        description: description,\n        investAmount: investAmount\n      })\n    }\n    this.setState({\n      currentAccount: accounts[0],\n      rawData: rawData,\n      shownData: rawData,\n      loading: false\n    })\n  }\n\n  async launch(name, description, totalAmount, deadline) {\n    const currentAccount = this.state.currentAccount;\n    let totalAmountWei = web3.utils.toWei(totalAmount.toString(), 'ether');\n    try {\n        await fundingInstance.methods.launch(name, description, totalAmountWei, deadline).send({\n          from: currentAccount,\n          gas: '3000000',\n        })\n        openSuccessMessage(\"筹款发布成功\")\n        window.location.reload()\n    } catch (e) {\n        openFailureMessage(\"筹款发布失败\")\n        console.log(e)\n    }\n  }\n\n  async invest(key, amount) {\n    const currentAccount = this.state.currentAccount\n    try {\n      await fundingInstance.methods.invest(key).send({\n        from: currentAccount,\n        value: web3.utils.toWei(amount.toString(), 'ether'),\n        gas: '3000000'\n      })\n      openSuccessMessage(\"投资成功\")\n      window.location.reload()\n    } catch(e) {\n      console.log(e)\n      openFailureMessage(\"投资失败\")\n    }\n  }\n\n  async request(key, purpose, amount) {\n    const amountWei = web3.utils.toWei(amount.toString(), 'ether')\n    const currentAccount = this.state.currentAccount\n    try {\n      await fundingInstance.methods.request(key, purpose, amountWei).send({\n        from: currentAccount,\n        gas: '3000000'\n      })\n      openSuccessMessage(\"请求成功\")\n      window.location.reload()\n    } catch(e) {\n      console.log(e)\n      openFailureMessage(\"请求失败\")\n    }\n  }\n\n  async vote(i, j, approve) {\n    const currentAccount = this.state.currentAccount;\n    try {\n      await fundingInstance.methods.vote(i, j, approve).send({\n        from: currentAccount,\n        gas: '3000000'\n      })\n      openSuccessMessage(\"投票成功\")\n      window.location.reload()\n    } catch(e) {\n      console.log(e)\n      openFailureMessage(\"投票失败\")\n    }\n  }\n\n  async openDetailView(key) {\n    let counts = await fundingInstance.methods.getFundingRequestCount(key).call()\n    let requests = []\n    for(let j = 0;j < counts;j++) {\n      let purpose = await fundingInstance.methods.getFundingRequestPurpose(key, j).call()\n      let approveVotesWei = await fundingInstance.methods.getFundingRequestApproveVotes(key, j).call()\n      let approveVotes = web3.utils.fromWei(approveVotesWei.toString(), 'ether')\n      let disapproveVotesWei = await fundingInstance.methods.getFundingRequestDisapproveVotes(key, j).call()\n      let disapproveVotes = web3.utils.fromWei(disapproveVotesWei.toString(), 'ether')\n      let totalAmountWei = await fundingInstance.methods.getFundingRequestTotalAmount(key, j).call()\n      let totalAmount = web3.utils.fromWei(totalAmountWei.toString(), 'ether')\n      let isVoted = await fundingInstance.methods.getFundingRequestIsVoted(key, j).call()\n      requests.push({\n        idx: j,\n        purpose: purpose,\n        approveVotes: approveVotes,\n        disapproveVotes: disapproveVotes,\n        totalAmount: totalAmount,\n        isVoted: isVoted\n      })\n    }\n    this.setState((state) => ({\n      detail: state.rawData[key],\n      requests: requests\n    }))\n    this.setState({isDetailVisible: true});\n  }\n\n  changeShownData(tag) {\n    const rawData = this.state.rawData;\n    const currentAccount = this.state.currentAccount;\n    if(tag === \"all\") {\n      this.setState({shownData: rawData})\n    } else if(tag === \"myLaunch\") {\n      this.setState({shownData: rawData.filter(item => item.launcher === currentAccount)})\n    } else if(tag === \"myInvest\") {\n      this.setState({shownData: rawData.filter(item => parseInt(item.investAmount) !== 0)})\n    } else if(tag === \"Unfinished\") {\n      this.setState({shownData: rawData.filter(item => item.currentAmount !== item.totalAmount)})\n    }\n  }\n\n  render() {\n    return (\n      <Layout className=\"layout\" style={{height: \"100vh\"}}>\n        <Header>\n          <Row>\n            <Col span={2} style={{margin: \"auto\"}}><font color=\"white\">{this.state.currentAccount}</font></Col>\n            <Col span={6}></Col>\n            <Col span={6}></Col>\n            <Col span={6}></Col>\n            <Col span={2}></Col>\n          </Row>\n        </Header>\n        <Content style={{overflow:\"auto\", padding: \"20px 20px\"}}>\n          <Spin spinning={this.state.loading} size=\"large\">\n            <Modal\n              title=\"发布筹资\"\n              visible={this.state.isLaunchVisible}\n              footer={null}\n              onCancel={() => {this.setState({isLaunchVisible:false})}}\n            >\n              <LaunchForm onClick={this.launch}/>\n            </Modal>\n            <Modal\n              title=\"详情和操作\"\n              visible={this.state.isDetailVisible}\n              footer={null}\n              width=\"600px\"\n              onCancel={() => {this.setState({isDetailVisible:false})}}\n            >\n              <DetailPage \n                {...this.state.detail}\n                requests={this.state.requests}\n                invest={this.invest}\n                request={this.request}\n                vote={this.vote}\n                currentAccount={this.state.currentAccount}\n              />\n            </Modal>\n            \n            <Radio.Group size=\"large\" onChange={e => this.changeShownData(e.target.value)} defaultValue=\"所有项目\">\n              <Radio.Button value=\"all\">所有项目</Radio.Button>\n              <Radio.Button value=\"myLaunch\">我发起的</Radio.Button>\n              <Radio.Button value=\"myInvest\">我投资的</Radio.Button>\n              <Radio.Button value=\"Unfinished\">未完成的</Radio.Button>\n              <Button size=\"large\" type=\"link\" style={{visibility: this.state.loading ? \"hidden\" : \"visible\"}} onClick={() => this.setState({isLaunchVisible: true})}>发布筹资</Button>\n            </Radio.Group>\n            <Table columns={this.state.columns} dataSource={this.state.shownData} pagination={{pageSize: 8}} />\n          </Spin>\n        </Content>\n        <Footer style={{ backgroundColor: \"rgba(0, 0, 0, 0.85)\", color: \"white\", textAlign: 'center' }}>Funding ©2021 Created by byr</Footer>\n      </Layout>\n    )\n  }\n};\n"]},"metadata":{},"sourceType":"module"}