{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"D:\\\\\\u6D59\\u5927\\u5B66\\u4E60\\u5DE5\\u4F5C\\\\\\u533A\\u5757\\u94FE\\\\iFunding_original\\\\src\\\\App.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React from \"react\";\nimport { Row, Col, Layout, Button, Radio, Space, Table, Progress, Modal, Form, Input, InputNumber, DatePicker, Divider, List, message, Spin, Tag, Tooltip, Descriptions } from 'antd';\nimport web3 from './utils/InitWeb3';\nimport fundingInstance from './eth/iFunding';\nconst {\n  Header,\n  Content,\n  Footer\n} = Layout;\nconst {\n  TextArea\n} = Input;\n\nconst truncate = num => Math.floor(100 * num) / 100;\n\nconst openSuccessMessage = text => {\n  message.success(text);\n};\n\nconst openFailureMessage = text => {\n  message.error(text);\n};\n\nconst LaunchForm = props => {\n  _s();\n\n  const [form] = Form.useForm();\n\n  const onFinish = values => {\n    props.onClick(values.name, values.description, values.totalAmount, values.deadline.unix());\n  };\n\n  const onReset = () => {\n    form.resetFields();\n  };\n\n  return /*#__PURE__*/_jsxDEV(Form, {\n    form: form,\n    name: \"control-hooks\",\n    onFinish: onFinish,\n    children: [/*#__PURE__*/_jsxDEV(Form.Item, {\n      name: \"name\",\n      label: \"\\u540D\\u79F0\",\n      rules: [{\n        required: true\n      }],\n      children: /*#__PURE__*/_jsxDEV(Input, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 30,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 29,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n      name: \"description\",\n      label: \"\\u4ECB\\u7ECD\",\n      rules: [{\n        required: true\n      }],\n      children: /*#__PURE__*/_jsxDEV(TextArea, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 33,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 32,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n      name: \"totalAmount\",\n      label: \"\\u91D1\\u989D\",\n      rules: [{\n        required: true\n      }],\n      children: /*#__PURE__*/_jsxDEV(InputNumber, {\n        min: 1\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 36,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 35,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n      name: \"deadline\",\n      label: \"\\u5230\\u671F\\u65E5\",\n      rules: [{\n        required: true\n      }],\n      children: /*#__PURE__*/_jsxDEV(DatePicker, {\n        type: \"date\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 39,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 38,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n      children: /*#__PURE__*/_jsxDEV(Space, {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          type: \"primary\",\n          htmlType: \"submit\",\n          children: \"\\u53D1\\u8D77\\u4F17\\u7B79\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 43,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          htmlType: \"button\",\n          onClick: onReset,\n          children: \"\\u91CD\\u7F6E\\u53C2\\u6570\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 46,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 42,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 28,\n    columnNumber: 5\n  }, this);\n};\n\n_s(LaunchForm, \"rI7DrJIrFu7YmlGWYiMFTzs8jF0=\", false, function () {\n  return [Form.useForm];\n});\n\n_c = LaunchForm;\n\nconst RequestForm = props => {\n  _s2();\n\n  const [form] = Form.useForm();\n\n  const onFinish = values => {\n    props.onClick(props.idx, values.purpose, values.totalAmount);\n  };\n\n  const onReset = () => {\n    form.resetFields();\n  };\n\n  return /*#__PURE__*/_jsxDEV(Form, {\n    form: form,\n    name: \"control-hooks\",\n    onFinish: onFinish,\n    children: [/*#__PURE__*/_jsxDEV(Form.Item, {\n      name: \"purpose\",\n      label: \"\\u76EE\\u7684\",\n      rules: [{\n        required: true\n      }],\n      children: /*#__PURE__*/_jsxDEV(Input, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n      name: \"totalAmount\",\n      label: \"\\u91D1\\u989D\",\n      rules: [{\n        required: true\n      }],\n      children: /*#__PURE__*/_jsxDEV(InputNumber, {\n        min: 1,\n        max: props.leftAmount\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n      children: /*#__PURE__*/_jsxDEV(Space, {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          type: \"primary\",\n          htmlType: \"submit\",\n          children: \"\\u53D1\\u8D77\\u8BF7\\u6C42\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          htmlType: \"button\",\n          onClick: onReset,\n          children: \"\\u91CD\\u7F6E\\u53C2\\u6570\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 67,\n    columnNumber: 5\n  }, this);\n};\n\n_s2(RequestForm, \"rI7DrJIrFu7YmlGWYiMFTzs8jF0=\", false, function () {\n  return [Form.useForm];\n});\n\n_c2 = RequestForm;\n\nconst BasicInfo = props => {\n  const tag = props.isOutdated ? /*#__PURE__*/_jsxDEV(Tag, {\n    color: \"error\",\n    children: \"\\u5230\\u671F\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 93,\n    columnNumber: 7\n  }, this) : props.currentAmount === props.totalAmount ? /*#__PURE__*/_jsxDEV(Tag, {\n    color: \"success\",\n    children: \"\\u5B8C\\u6210\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 96,\n    columnNumber: 11\n  }, this) : /*#__PURE__*/_jsxDEV(Tag, {\n    color: \"processing\",\n    children: \"\\u8FDB\\u884C\\u4E2D\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 97,\n    columnNumber: 11\n  }, this);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Divider, {\n      orientation: \"left\",\n      children: \"\\u57FA\\u672C\\u4FE1\\u606F\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Descriptions, {\n      bordered: true,\n      size: \"small\",\n      column: 1,\n      children: [/*#__PURE__*/_jsxDEV(Descriptions.Item, {\n        label: \"\\u540D\\u79F0\",\n        children: props.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Descriptions.Item, {\n        label: \"\\u72B6\\u6001\",\n        children: tag\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Descriptions.Item, {\n        label: \"\\u5730\\u5740\",\n        children: props.address\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Descriptions.Item, {\n        label: \"\\u53D1\\u8D77\\u4EBA\",\n        children: props.launcher\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Descriptions.Item, {\n        label: \"\\u96C6\\u8D44\\u8FDB\\u5EA6\",\n        children: `${props.currentAmount} ETH/${props.totalAmount} ETH`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Descriptions.Item, {\n        label: \"\\u6211\\u7684\\u6295\\u8D44\\u989D\\u5EA6\",\n        children: [props.investAmount, \" ETH\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Descriptions.Item, {\n        label: \"\\u5230\\u671F\\u65F6\\u95F4\",\n        children: new Date(props.deadline * 1000).toLocaleDateString()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Descriptions.Item, {\n        label: \"\\u8BE6\\u7EC6\\u4FE1\\u606F\",\n        children: props.description\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n\n_c3 = BasicInfo;\n\nclass InvestView extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      amount: 1\n    };\n  }\n\n  render() {\n    const leftAmount = this.props.totalAmount - this.props.currentAmount;\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Divider, {\n        orientation: \"left\",\n        children: \"\\u6295\\u8D44\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: `投资金额不可超过剩余集资金额(${leftAmount} ETH)`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Space, {\n        children: [/*#__PURE__*/_jsxDEV(InputNumber, {\n          min: 1,\n          max: leftAmount,\n          defaultValue: 1,\n          onChange: value => {\n            this.setState({\n              amount: value\n            });\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          type: \"primary\",\n          onClick: () => this.props.invest(this.props.idx, this.state.amount),\n          children: \"\\u6295\\u8D44\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true);\n  }\n\n}\n\nclass RequestView extends React.Component {\n  render() {\n    const invested = () => parseInt(this.props.investAmount) !== 0;\n\n    const approved = item => parseInt(item.approveVotes) > parseInt(item.totalAmount) / 2;\n\n    const disapproved = item => parseInt(item.disapproveVotes) > parseInt(item.totalAmount) / 2;\n\n    const finished = item => approved(item) || disapproved(item);\n\n    const tag = item => approved(item) ? /*#__PURE__*/_jsxDEV(Tag, {\n      color: \"success\",\n      children: \"\\u901A\\u8FC7\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 7\n    }, this) : disapproved(item) ? /*#__PURE__*/_jsxDEV(Tag, {\n      color: \"error\",\n      children: \"\\u5426\\u51B3\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(Tag, {\n      color: \"processing\",\n      children: \"\\u8FDB\\u884C\\u4E2D\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 9\n    }, this);\n\n    const votedText = \"您已投过票了，无法再投\";\n\n    const votedButtons = () => [/*#__PURE__*/_jsxDEV(Tooltip, {\n      placement: \"top\",\n      title: votedText,\n      children: /*#__PURE__*/_jsxDEV(Button, {\n        disabled: true,\n        children: \"\\u540C\\u610F\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Tooltip, {\n      placement: \"top\",\n      title: votedText,\n      children: /*#__PURE__*/_jsxDEV(Button, {\n        disabled: true,\n        children: \"\\u53CD\\u5BF9\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 7\n    }, this)];\n\n    const nonVotedButtons = item => [/*#__PURE__*/_jsxDEV(Button, {\n      onClick: () => {\n        this.props.vote(this.props.idx, item.idx, true);\n      },\n      children: \"\\u540C\\u610F\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Button, {\n      onClick: () => {\n        this.props.vote(this.props.idx, item.idx, false);\n      },\n      children: \"\\u53CD\\u5BF9\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 7\n    }, this)];\n\n    const shownButtons = item => this.props.isVoted ? votedButtons() : nonVotedButtons(item);\n\n    const leftVotes = item => parseInt(this.props.totalAmount) - parseInt(item.approveVotes) - parseInt(item.disapproveVotes);\n\n    const shownText = item => `${item.purpose}: ${item.totalAmount} ETH(${item.approveVotes}/${item.disapproveVotes}/${leftVotes(item)})`;\n\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Divider, {\n        orientation: \"left\",\n        children: \"\\u8D44\\u91D1\\u8BF7\\u6C42\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: `资金请求需由50%的票数批准才可通过，您的票数:${this.props.investAmount}`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\u62EC\\u53F7\\u5185\\u4E3A(\\u8D5E\\u6210/\\u53CD\\u5BF9/\\u672A\\u6295)\\u7684\\u7968\\u6570\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(List, {\n        bordered: true,\n        dataSource: this.props.requests,\n        renderItem: item => /*#__PURE__*/_jsxDEV(List.Item, {\n          actions: !finished(item) && invested && shownButtons(item),\n          children: [shownText(item), tag(item)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true);\n  }\n\n}\n\nclass CreateRequestView extends React.Component {\n  render() {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Divider, {\n        orientation: \"left\",\n        children: \"\\u53D1\\u8D77\\u8D44\\u91D1\\u8BF7\\u6C42\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: `请求金额不可超过当前资金池(${this.props.leftAmount} ETH)`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(RequestForm, { ...this.props,\n        onClick: this.props.request\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true);\n  }\n\n}\n\nclass DetailPage extends React.Component {\n  render() {\n    const isOutdated = this.props.deadline * 1000 < new Date().getTime();\n    const finished = this.props.currentAmount === this.props.totalAmount;\n    const showInvestView = !isOutdated && !finished;\n    const showCreateRequestView = !isOutdated && this.props.launcher === this.props.currentAccount && finished;\n    const showRequestView = !isOutdated && finished && (parseInt(this.props.investAmount) !== 0 || this.props.launcher === this.props.currentAccount);\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(BasicInfo, { ...this.props,\n        isOutdated: isOutdated\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 9\n      }, this), !isOutdated && showInvestView && /*#__PURE__*/_jsxDEV(InvestView, { ...this.props\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 43\n      }, this), !isOutdated && showCreateRequestView && /*#__PURE__*/_jsxDEV(CreateRequestView, { ...this.props\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 50\n      }, this), !isOutdated && showRequestView && /*#__PURE__*/_jsxDEV(RequestView, { ...this.props\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 44\n      }, this)]\n    }, void 0, true);\n  }\n\n}\n\nexport default class App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      currentAccount: '未登录的游客',\n      rawData: [],\n      shownData: [],\n      isLaunchVisible: false,\n      isDetailVisible: false,\n      columns: [{\n        title: '项目名称',\n        dataIndex: 'name',\n        key: 'name'\n      }, {\n        title: '发起人',\n        dataIndex: 'launcher',\n        key: 'launcher'\n      }, {\n        title: '集资进度',\n        key: 'progress-money',\n        render: (text, record) => /*#__PURE__*/_jsxDEV(Progress, {\n          percent: truncate(100 * record.currentAmount / record.totalAmount)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 13\n        }, this)\n      }, {\n        title: '到期时间',\n        dataIndex: 'deadline',\n        key: 'progress-time',\n        render: deadline => /*#__PURE__*/_jsxDEV(\"p\", {\n          children: new Date(deadline * 1000).toLocaleDateString()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 13\n        }, this)\n      }, {\n        title: '查看详情',\n        key: 'detail',\n        render: (text, record) => /*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => this.openDetailView(record.key),\n          children: \"\\u67E5\\u770B\\u8BE6\\u60C5\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 13\n        }, this)\n      }],\n      detail: {},\n      requests: [],\n      loading: true\n    };\n    this.openDetailView = this.openDetailView.bind(this);\n    this.changeShownData = this.changeShownData.bind(this);\n    this.launch = this.launch.bind(this);\n    this.invest = this.invest.bind(this);\n    this.request = this.request.bind(this);\n    this.vote = this.vote.bind(this);\n  }\n\n  async componentDidMount() {\n    let accounts = await web3.eth.getAccounts();\n    let counts = await fundingInstance.methods.getFundingsCount().call();\n    let rawData = [];\n\n    for (let i = 0; i < counts; i++) {\n      let key = i;\n      let name = await fundingInstance.methods.getFundingName(i).call();\n      let address = await fundingInstance.methods.getFundingAddress(i).call();\n      let launcher = await fundingInstance.methods.getFundingLauncher(i).call();\n      let currentAmountWei = await fundingInstance.methods.getFundingCurrentAmount(i).call();\n      let currentAmount = web3.utils.fromWei(currentAmountWei, 'ether');\n      let totalAmountWei = await fundingInstance.methods.getFundingTotalAmount(i).call();\n      let totalAmount = web3.utils.fromWei(totalAmountWei, 'ether');\n      let leftAmountWei = await fundingInstance.methods.getFundingLeftAmount(i).call();\n      let leftAmount = web3.utils.fromWei(leftAmountWei, 'ether');\n      let deadline = await fundingInstance.methods.getFundingDeadline(i).call();\n      let description = await fundingInstance.methods.getFundingDescription(i).call();\n      let investAmountWei = await fundingInstance.methods.getFundingInvestment(i, accounts[0]).call();\n      let investAmount = web3.utils.fromWei(investAmountWei, 'ether');\n      rawData.push({\n        key: key,\n        idx: key,\n        name: name,\n        address: address,\n        launcher: launcher,\n        currentAmount: currentAmount,\n        totalAmount: totalAmount,\n        leftAmount: leftAmount,\n        deadline: deadline,\n        description: description,\n        investAmount: investAmount\n      });\n    }\n\n    this.setState({\n      currentAccount: accounts[0],\n      rawData: rawData,\n      shownData: rawData,\n      loading: false\n    });\n  }\n\n  async launch(name, description, totalAmount, deadline) {\n    const currentAccount = this.state.currentAccount;\n    let totalAmountWei = web3.utils.toWei(totalAmount.toString(), 'ether');\n\n    try {\n      await fundingInstance.methods.launch(name, description, totalAmountWei, deadline).send({\n        from: currentAccount,\n        gas: '3000000'\n      });\n      openSuccessMessage(\"发布成功\");\n      window.location.reload();\n    } catch (e) {\n      openFailureMessage(\"发布失败\");\n      console.log(e);\n    }\n  }\n\n  async invest(key, amount) {\n    const currentAccount = this.state.currentAccount;\n\n    try {\n      await fundingInstance.methods.invest(key).send({\n        from: currentAccount,\n        value: web3.utils.toWei(amount.toString(), 'ether'),\n        gas: '3000000'\n      });\n      openSuccessMessage(\"投资成功\");\n      window.location.reload();\n    } catch (e) {\n      console.log(e);\n      openFailureMessage(\"投资失败\");\n    }\n  }\n\n  async request(key, purpose, amount) {\n    const amountWei = web3.utils.toWei(amount.toString(), 'ether');\n    const currentAccount = this.state.currentAccount;\n\n    try {\n      await fundingInstance.methods.request(key, purpose, amountWei).send({\n        from: currentAccount,\n        gas: '3000000'\n      });\n      openSuccessMessage(\"请求成功\");\n      window.location.reload();\n    } catch (e) {\n      console.log(e);\n      openFailureMessage(\"请求失败\");\n    }\n  }\n\n  async vote(i, j, approve) {\n    const currentAccount = this.state.currentAccount;\n\n    try {\n      await fundingInstance.methods.vote(i, j, approve).send({\n        from: currentAccount,\n        gas: '3000000'\n      });\n      openSuccessMessage(\"投票成功\");\n      window.location.reload();\n    } catch (e) {\n      console.log(e);\n      openFailureMessage(\"投票失败\");\n    }\n  }\n\n  async openDetailView(key) {\n    let counts = await fundingInstance.methods.getFundingRequestCount(key).call();\n    let requests = [];\n\n    for (let j = 0; j < counts; j++) {\n      let purpose = await fundingInstance.methods.getFundingRequestPurpose(key, j).call();\n      let approveVotesWei = await fundingInstance.methods.getFundingRequestApproveVotes(key, j).call();\n      let approveVotes = web3.utils.fromWei(approveVotesWei.toString(), 'ether');\n      let disapproveVotesWei = await fundingInstance.methods.getFundingRequestDisapproveVotes(key, j).call();\n      let disapproveVotes = web3.utils.fromWei(disapproveVotesWei.toString(), 'ether');\n      let totalAmountWei = await fundingInstance.methods.getFundingRequestTotalAmount(key, j).call();\n      let totalAmount = web3.utils.fromWei(totalAmountWei.toString(), 'ether');\n      let isVoted = await fundingInstance.methods.getFundingRequestIsVoted(key, j).call();\n      requests.push({\n        idx: j,\n        purpose: purpose,\n        approveVotes: approveVotes,\n        disapproveVotes: disapproveVotes,\n        totalAmount: totalAmount,\n        isVoted: isVoted\n      });\n    }\n\n    this.setState(state => ({\n      detail: state.rawData[key],\n      requests: requests\n    }));\n    this.setState({\n      isDetailVisible: true\n    });\n  }\n\n  changeShownData(tag) {\n    const rawData = this.state.rawData;\n    const currentAccount = this.state.currentAccount;\n\n    if (tag === \"所有项目\") {\n      this.setState({\n        shownData: rawData\n      });\n    } else if (tag === \"我发起的项目\") {\n      this.setState({\n        shownData: rawData.filter(item => item.launcher === currentAccount)\n      });\n    } else if (tag === \"我投资的项目\") {\n      this.setState({\n        shownData: rawData.filter(item => parseInt(item.investAmount) !== 0)\n      });\n    } else if (tag === \"未完成的项目\") {\n      this.setState({\n        shownData: rawData.filter(item => item.currentAmount !== item.totalAmount)\n      });\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(Layout, {\n      className: \"layout\",\n      style: {\n        height: \"100vh\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(Header, {\n        children: /*#__PURE__*/_jsxDEV(Row, {\n          children: [/*#__PURE__*/_jsxDEV(Col, {\n            span: 6,\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: \"http://course.zju.edu.cn/img/user/logo.png\",\n              alt: \"\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 432,\n              columnNumber: 27\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 432,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Col, {\n            span: 6\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 433,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Col, {\n            span: 6\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 434,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Col, {\n            span: 4\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 435,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Col, {\n            span: 2,\n            style: {\n              margin: \"auto\"\n            },\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              type: \"primary\",\n              style: {\n                visibility: this.state.loading ? \"hidden\" : \"visible\"\n              },\n              onClick: () => this.setState({\n                isLaunchVisible: true\n              }),\n              children: \"\\u53D1\\u5E03\\u4F17\\u7B79\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 436,\n              columnNumber: 52\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 436,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 431,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 430,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Content, {\n        style: {\n          overflow: \"auto\",\n          padding: \"20px 20px\"\n        },\n        children: /*#__PURE__*/_jsxDEV(Spin, {\n          spinning: this.state.loading,\n          size: \"large\",\n          children: [/*#__PURE__*/_jsxDEV(Modal, {\n            title: \"\\u53D1\\u5E03\\u4F17\\u7B79\",\n            visible: this.state.isLaunchVisible,\n            footer: null,\n            onCancel: () => {\n              this.setState({\n                isLaunchVisible: false\n              });\n            },\n            children: /*#__PURE__*/_jsxDEV(LaunchForm, {\n              onClick: this.launch\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 447,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 441,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Modal, {\n            title: \"\\u4F17\\u7B79\\u8BE6\\u60C5\",\n            visible: this.state.isDetailVisible,\n            footer: null,\n            width: \"600px\",\n            onCancel: () => {\n              this.setState({\n                isDetailVisible: false\n              });\n            },\n            children: /*#__PURE__*/_jsxDEV(DetailPage, { ...this.state.detail,\n              requests: this.state.requests,\n              invest: this.invest,\n              request: this.request,\n              vote: this.vote,\n              currentAccount: this.state.currentAccount\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 456,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 449,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [this.state.currentAccount, \": \\u6B22\\u8FCE\\u4F7F\\u7528iFunding\\uFF01\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 465,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Radio.Group, {\n            size: \"large\",\n            onChange: e => this.changeShownData(e.target.value),\n            defaultValue: \"\\u6240\\u6709\\u9879\\u76EE\",\n            children: [/*#__PURE__*/_jsxDEV(Radio.Button, {\n              value: \"\\u6240\\u6709\\u9879\\u76EE\",\n              children: \"\\u6240\\u6709\\u9879\\u76EE\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 467,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Radio.Button, {\n              value: \"\\u6211\\u53D1\\u8D77\\u7684\\u9879\\u76EE\",\n              children: \"\\u6211\\u53D1\\u8D77\\u7684\\u9879\\u76EE\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 468,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Radio.Button, {\n              value: \"\\u6211\\u6295\\u8D44\\u7684\\u9879\\u76EE\",\n              children: \"\\u6211\\u6295\\u8D44\\u7684\\u9879\\u76EE\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 469,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Radio.Button, {\n              value: \"\\u672A\\u5B8C\\u6210\\u7684\\u9879\\u76EE\",\n              children: \"\\u672A\\u5B8C\\u6210\\u7684\\u9879\\u76EE\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 470,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 466,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Table, {\n            columns: this.state.columns,\n            dataSource: this.state.shownData,\n            pagination: {\n              pageSize: 8\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 472,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 440,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 439,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Footer, {\n        style: {\n          backgroundColor: \"rgba(0, 0, 0, 0.85)\",\n          color: \"white\",\n          textAlign: 'center'\n        },\n        children: \"iFunding \\xA92021 Created by NessOffice\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 475,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 429,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n;\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"LaunchForm\");\n$RefreshReg$(_c2, \"RequestForm\");\n$RefreshReg$(_c3, \"BasicInfo\");","map":{"version":3,"sources":["D:/浙大学习工作/区块链/iFunding_original/src/App.js"],"names":["React","Row","Col","Layout","Button","Radio","Space","Table","Progress","Modal","Form","Input","InputNumber","DatePicker","Divider","List","message","Spin","Tag","Tooltip","Descriptions","web3","fundingInstance","Header","Content","Footer","TextArea","truncate","num","Math","floor","openSuccessMessage","text","success","openFailureMessage","error","LaunchForm","props","form","useForm","onFinish","values","onClick","name","description","totalAmount","deadline","unix","onReset","resetFields","required","RequestForm","idx","purpose","leftAmount","BasicInfo","tag","isOutdated","currentAmount","address","launcher","investAmount","Date","toLocaleDateString","InvestView","Component","constructor","state","amount","render","value","setState","invest","RequestView","invested","parseInt","approved","item","approveVotes","disapproved","disapproveVotes","finished","votedText","votedButtons","nonVotedButtons","vote","shownButtons","isVoted","leftVotes","shownText","requests","CreateRequestView","request","DetailPage","getTime","showInvestView","showCreateRequestView","currentAccount","showRequestView","App","rawData","shownData","isLaunchVisible","isDetailVisible","columns","title","dataIndex","key","record","openDetailView","detail","loading","bind","changeShownData","launch","componentDidMount","accounts","eth","getAccounts","counts","methods","getFundingsCount","call","i","getFundingName","getFundingAddress","getFundingLauncher","currentAmountWei","getFundingCurrentAmount","utils","fromWei","totalAmountWei","getFundingTotalAmount","leftAmountWei","getFundingLeftAmount","getFundingDeadline","getFundingDescription","investAmountWei","getFundingInvestment","push","toWei","toString","send","from","gas","window","location","reload","e","console","log","amountWei","j","approve","getFundingRequestCount","getFundingRequestPurpose","approveVotesWei","getFundingRequestApproveVotes","disapproveVotesWei","getFundingRequestDisapproveVotes","getFundingRequestTotalAmount","getFundingRequestIsVoted","filter","height","margin","visibility","overflow","padding","target","pageSize","backgroundColor","color","textAlign"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { Row, Col, Layout, Button, Radio, Space, Table, Progress, Modal, Form, Input, InputNumber, DatePicker, Divider, List, message, Spin, Tag, Tooltip, Descriptions } from 'antd';\nimport web3 from './utils/InitWeb3';\nimport fundingInstance from './eth/iFunding';\nconst { Header, Content, Footer } = Layout;\nconst { TextArea } = Input;\n\nconst truncate = (num) => Math.floor(100*num)/100\nconst openSuccessMessage = (text) => {\n  message.success(text);\n}\nconst openFailureMessage = (text) => {\n  message.error(text);\n}\n\nconst LaunchForm = (props) => {\n  const [form] = Form.useForm();\n\n  const onFinish = (values) => {\n    props.onClick(values.name, values.description, values.totalAmount, values.deadline.unix())\n  };\n\n  const onReset = () => {\n    form.resetFields();\n  };\n\n  return (\n    <Form form={form} name=\"control-hooks\" onFinish={onFinish}>\n      <Form.Item name=\"name\" label=\"名称\" rules={[{ required: true }]}>\n        <Input />\n      </Form.Item>\n      <Form.Item name=\"description\" label=\"介绍\" rules={[{ required: true }]}>\n        <TextArea />\n      </Form.Item>\n      <Form.Item name=\"totalAmount\" label=\"金额\" rules={[{ required: true }]}>\n        <InputNumber min={1}/>\n      </Form.Item>\n      <Form.Item name=\"deadline\" label=\"到期日\" rules={[{ required: true }]}>\n        <DatePicker type=\"date\" />\n      </Form.Item>\n      <Form.Item>\n        <Space>\n          <Button type=\"primary\" htmlType=\"submit\">\n            发起众筹\n          </Button>\n          <Button htmlType=\"button\" onClick={onReset}>\n            重置参数\n          </Button>\n        </Space>\n      </Form.Item>\n    </Form>\n  );\n};\n\nconst RequestForm = (props) => {\n  const [form] = Form.useForm();\n\n  const onFinish = (values) => {\n    props.onClick(props.idx, values.purpose, values.totalAmount)\n  };\n\n  const onReset = () => {\n    form.resetFields();\n  };\n\n  return (\n    <Form form={form} name=\"control-hooks\" onFinish={onFinish}>\n      <Form.Item name=\"purpose\" label=\"目的\" rules={[{ required: true }]}>\n        <Input />\n      </Form.Item>\n      <Form.Item name=\"totalAmount\" label=\"金额\" rules={[{ required: true }]}>\n        <InputNumber\n          min={1}\n          max={props.leftAmount}\n        />\n      </Form.Item>\n      <Form.Item>\n        <Space>\n          <Button type=\"primary\" htmlType=\"submit\">\n            发起请求\n          </Button>\n          <Button htmlType=\"button\" onClick={onReset}>\n            重置参数\n          </Button>\n        </Space>\n      </Form.Item>\n    </Form>\n  );\n}\n\nconst BasicInfo = (props) => {\n  const tag = props.isOutdated\n    ? <Tag color=\"error\">到期</Tag>\n    : (\n      props.currentAmount === props.totalAmount\n        ? <Tag color=\"success\">完成</Tag>\n        : <Tag color=\"processing\">进行中</Tag>\n    )\n  return (\n    <>\n      <Divider orientation=\"left\">基本信息</Divider>\n      <Descriptions bordered size=\"small\" column={1}>\n        <Descriptions.Item label=\"名称\">{props.name}</Descriptions.Item>\n        <Descriptions.Item label=\"状态\">{tag}</Descriptions.Item>\n        <Descriptions.Item label=\"地址\">{props.address}</Descriptions.Item>\n        <Descriptions.Item label=\"发起人\">{props.launcher}</Descriptions.Item>\n        <Descriptions.Item label=\"集资进度\">{`${props.currentAmount} ETH/${props.totalAmount} ETH`}</Descriptions.Item>\n        <Descriptions.Item label=\"我的投资额度\">{props.investAmount} ETH</Descriptions.Item>\n        <Descriptions.Item label=\"到期时间\">{(new Date(props.deadline * 1000)).toLocaleDateString()}</Descriptions.Item>\n        <Descriptions.Item label=\"详细信息\">{props.description}</Descriptions.Item>\n      </Descriptions>\n    </>\n  )\n}\nclass InvestView extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      amount: 1\n    }\n  }\n\n  render() {\n    const leftAmount = this.props.totalAmount - this.props.currentAmount;\n    return (\n      <>\n        <Divider orientation=\"left\">投资</Divider>\n        <p>{`投资金额不可超过剩余集资金额(${leftAmount} ETH)`}</p>\n        <Space>\n          <InputNumber\n            min={1}\n            max={leftAmount}\n            defaultValue={1}\n            onChange={(value) => {this.setState({amount: value})}}\n          />\n          <Button\n            type=\"primary\"\n            onClick={() => this.props.invest(this.props.idx, this.state.amount)}\n          >\n            投资\n          </Button>\n        </Space>\n      </>\n    )\n  }\n}\nclass RequestView extends React.Component {\n  render() {\n    const invested = () => (parseInt(this.props.investAmount) !== 0)\n    const approved = (item) => (parseInt(item.approveVotes) > parseInt(item.totalAmount)/2)\n    const disapproved = (item) => (parseInt(item.disapproveVotes) > parseInt(item.totalAmount)/2)\n    const finished = (item) => (approved(item) || disapproved(item))\n    const tag = (item) => (approved(item) ? \n      <Tag color=\"success\">通过</Tag> :\n      (disapproved(item) ?\n        <Tag color=\"error\">否决</Tag> :\n        <Tag color=\"processing\">进行中</Tag>\n      )\n    )\n\n    const votedText = \"您已投过票了，无法再投\"\n    const votedButtons = () => [\n      <Tooltip placement=\"top\" title={votedText}>\n        <Button disabled>同意</Button>\n      </Tooltip>,\n      <Tooltip placement=\"top\" title={votedText}>\n      <Button disabled>反对</Button>\n    </Tooltip>\n    ]\n    const nonVotedButtons = (item) => [\n      <Button onClick={() => {this.props.vote(this.props.idx, item.idx, true)}}>同意</Button>,\n      <Button onClick={() => {this.props.vote(this.props.idx, item.idx, false)}}>反对</Button>\n    ]\n    const shownButtons = (item) => this.props.isVoted ? votedButtons() : nonVotedButtons(item)\n    \n    const leftVotes = (item) => (parseInt(this.props.totalAmount) - parseInt(item.approveVotes) - parseInt(item.disapproveVotes))\n    const shownText = (item) => `${item.purpose}: ${item.totalAmount} ETH(${item.approveVotes}/${item.disapproveVotes}/${leftVotes(item)})`\n\n    return (\n      <>\n        <Divider orientation=\"left\">资金请求</Divider>\n        <p>{`资金请求需由50%的票数批准才可通过，您的票数:${this.props.investAmount}`}</p>\n        <p>括号内为(赞成/反对/未投)的票数</p>\n        <List\n          bordered\n          dataSource={this.props.requests}\n          renderItem={item => (\n            <List.Item actions={!finished(item) && invested && shownButtons(item)}>\n              {shownText(item)}{tag(item)}\n            </List.Item>\n          )}\n        />\n      </>\n    )\n  }\n}\nclass CreateRequestView extends React.Component {\n  render() {\n    return (\n      <>\n        <Divider orientation=\"left\">发起资金请求</Divider>\n        <p>{`请求金额不可超过当前资金池(${this.props.leftAmount} ETH)`}</p>\n        <RequestForm {...this.props} onClick={this.props.request} />\n      </>\n    )\n  }\n}\nclass DetailPage extends React.Component {\n  render() {\n    const isOutdated = (this.props.deadline*1000 < (new Date()).getTime())\n    const finished = (this.props.currentAmount === this.props.totalAmount)\n    const showInvestView = (!isOutdated) && (!finished);\n    const showCreateRequestView = (!isOutdated) && (this.props.launcher === this.props.currentAccount) && (finished);\n    const showRequestView = (!isOutdated) && (finished) && ((parseInt(this.props.investAmount) !== 0) || (this.props.launcher === this.props.currentAccount));\n    return (\n      <>\n        <BasicInfo {...this.props} isOutdated={isOutdated} />\n        {!isOutdated && showInvestView && <InvestView {...this.props}/>}\n        {!isOutdated && showCreateRequestView && <CreateRequestView {...this.props}/>}\n        {!isOutdated && showRequestView && <RequestView {...this.props}/>}\n      </>\n    )\n  }\n}\n\nexport default class App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      currentAccount: '未登录的游客',\n      rawData: [],\n      shownData: [],\n      isLaunchVisible: false,\n      isDetailVisible: false,\n      columns: [\n        {\n          title: '项目名称',\n          dataIndex: 'name',\n          key: 'name',\n        },\n        {\n          title: '发起人',\n          dataIndex: 'launcher',\n          key: 'launcher',\n        },\n        {\n          title: '集资进度',\n          key: 'progress-money',\n          render: (text, record) => (\n            <Progress percent={truncate(100*record.currentAmount/record.totalAmount)}></Progress>\n          )\n        },\n        {\n          title: '到期时间',\n          dataIndex: 'deadline',\n          key: 'progress-time',\n          render: deadline => (\n            <p>{(new Date(deadline * 1000)).toLocaleDateString()}</p>\n          )\n        },\n        {\n          title: '查看详情',\n          key: 'detail',\n          render: (text, record) => (\n            <Button onClick={() => this.openDetailView(record.key)}>查看详情</Button>\n          ),\n        },\n      ],\n      detail: {},\n      requests: [],\n      loading: true,\n    }\n    this.openDetailView = this.openDetailView.bind(this)\n    this.changeShownData = this.changeShownData.bind(this)\n    this.launch = this.launch.bind(this)\n    this.invest = this.invest.bind(this)\n    this.request = this.request.bind(this)\n    this.vote = this.vote.bind(this)\n  }\n\n  async componentDidMount() {\n    let accounts = await web3.eth.getAccounts()\n    let counts = await fundingInstance.methods.getFundingsCount().call()\n    let rawData = []\n    for(let i = 0;i < counts;i++) {\n      let key = i;\n      let name = await fundingInstance.methods.getFundingName(i).call()\n      let address = await fundingInstance.methods.getFundingAddress(i).call()\n      let launcher = await fundingInstance.methods.getFundingLauncher(i).call()\n      let currentAmountWei = await fundingInstance.methods.getFundingCurrentAmount(i).call()\n      let currentAmount = web3.utils.fromWei(currentAmountWei, 'ether');\n      let totalAmountWei = await fundingInstance.methods.getFundingTotalAmount(i).call()\n      let totalAmount = web3.utils.fromWei(totalAmountWei, 'ether');\n      let leftAmountWei = await fundingInstance.methods.getFundingLeftAmount(i).call()\n      let leftAmount = web3.utils.fromWei(leftAmountWei, 'ether')\n      let deadline = await fundingInstance.methods.getFundingDeadline(i).call()\n      let description = await fundingInstance.methods.getFundingDescription(i).call()\n      let investAmountWei = await fundingInstance.methods.getFundingInvestment(i, accounts[0]).call()\n      let investAmount = web3.utils.fromWei(investAmountWei, 'ether')\n      rawData.push({\n        key: key,\n        idx: key,\n        name: name,\n        address: address,\n        launcher: launcher,\n        currentAmount: currentAmount,\n        totalAmount: totalAmount,\n        leftAmount: leftAmount,\n        deadline: deadline,\n        description: description,\n        investAmount: investAmount\n      })\n    }\n    this.setState({\n      currentAccount: accounts[0],\n      rawData: rawData,\n      shownData: rawData,\n      loading: false\n    })\n  }\n\n  async launch(name, description, totalAmount, deadline) {\n    const currentAccount = this.state.currentAccount;\n    let totalAmountWei = web3.utils.toWei(totalAmount.toString(), 'ether');\n    try {\n        await fundingInstance.methods.launch(name, description, totalAmountWei, deadline).send({\n          from: currentAccount,\n          gas: '3000000',\n        })\n        openSuccessMessage(\"发布成功\")\n        window.location.reload()\n    } catch (e) {\n        openFailureMessage(\"发布失败\")\n        console.log(e)\n    }\n  }\n\n  async invest(key, amount) {\n    const currentAccount = this.state.currentAccount\n    try {\n      await fundingInstance.methods.invest(key).send({\n        from: currentAccount,\n        value: web3.utils.toWei(amount.toString(), 'ether'),\n        gas: '3000000'\n      })\n      openSuccessMessage(\"投资成功\")\n      window.location.reload()\n    } catch(e) {\n      console.log(e)\n      openFailureMessage(\"投资失败\")\n    }\n  }\n\n  async request(key, purpose, amount) {\n    const amountWei = web3.utils.toWei(amount.toString(), 'ether')\n    const currentAccount = this.state.currentAccount\n    try {\n      await fundingInstance.methods.request(key, purpose, amountWei).send({\n        from: currentAccount,\n        gas: '3000000'\n      })\n      openSuccessMessage(\"请求成功\")\n      window.location.reload()\n    } catch(e) {\n      console.log(e)\n      openFailureMessage(\"请求失败\")\n    }\n  }\n\n  async vote(i, j, approve) {\n    const currentAccount = this.state.currentAccount;\n    try {\n      await fundingInstance.methods.vote(i, j, approve).send({\n        from: currentAccount,\n        gas: '3000000'\n      })\n      openSuccessMessage(\"投票成功\")\n      window.location.reload()\n    } catch(e) {\n      console.log(e)\n      openFailureMessage(\"投票失败\")\n    }\n  }\n\n  async openDetailView(key) {\n    let counts = await fundingInstance.methods.getFundingRequestCount(key).call()\n    let requests = []\n    for(let j = 0;j < counts;j++) {\n      let purpose = await fundingInstance.methods.getFundingRequestPurpose(key, j).call()\n      let approveVotesWei = await fundingInstance.methods.getFundingRequestApproveVotes(key, j).call()\n      let approveVotes = web3.utils.fromWei(approveVotesWei.toString(), 'ether')\n      let disapproveVotesWei = await fundingInstance.methods.getFundingRequestDisapproveVotes(key, j).call()\n      let disapproveVotes = web3.utils.fromWei(disapproveVotesWei.toString(), 'ether')\n      let totalAmountWei = await fundingInstance.methods.getFundingRequestTotalAmount(key, j).call()\n      let totalAmount = web3.utils.fromWei(totalAmountWei.toString(), 'ether')\n      let isVoted = await fundingInstance.methods.getFundingRequestIsVoted(key, j).call()\n      requests.push({\n        idx: j,\n        purpose: purpose,\n        approveVotes: approveVotes,\n        disapproveVotes: disapproveVotes,\n        totalAmount: totalAmount,\n        isVoted: isVoted\n      })\n    }\n    this.setState((state) => ({\n      detail: state.rawData[key],\n      requests: requests\n    }))\n    this.setState({isDetailVisible: true});\n  }\n\n  changeShownData(tag) {\n    const rawData = this.state.rawData;\n    const currentAccount = this.state.currentAccount;\n    if(tag === \"所有项目\") {\n      this.setState({shownData: rawData})\n    } else if(tag === \"我发起的项目\") {\n      this.setState({shownData: rawData.filter(item => item.launcher === currentAccount)})\n    } else if(tag === \"我投资的项目\") {\n      this.setState({shownData: rawData.filter(item => parseInt(item.investAmount) !== 0)})\n    } else if(tag === \"未完成的项目\") {\n      this.setState({shownData: rawData.filter(item => item.currentAmount !== item.totalAmount)})\n    }\n  }\n\n  render() {\n    return (\n      <Layout className=\"layout\" style={{height: \"100vh\"}}>\n        <Header>\n          <Row>\n            <Col span={6}><img src=\"http://course.zju.edu.cn/img/user/logo.png\" alt=\"\" /></Col>\n            <Col span={6}></Col>\n            <Col span={6}></Col>\n            <Col span={4}></Col>\n            <Col span={2} style={{margin: \"auto\"}}><Button type=\"primary\" style={{visibility: this.state.loading ? \"hidden\" : \"visible\"}} onClick={() => this.setState({isLaunchVisible: true})}>发布众筹</Button></Col>\n          </Row>\n        </Header>\n        <Content style={{overflow:\"auto\", padding: \"20px 20px\"}}>\n          <Spin spinning={this.state.loading} size=\"large\">\n            <Modal\n              title=\"发布众筹\"\n              visible={this.state.isLaunchVisible}\n              footer={null}\n              onCancel={() => {this.setState({isLaunchVisible:false})}}\n            >\n              <LaunchForm onClick={this.launch}/>\n            </Modal>\n            <Modal\n              title=\"众筹详情\"\n              visible={this.state.isDetailVisible}\n              footer={null}\n              width=\"600px\"\n              onCancel={() => {this.setState({isDetailVisible:false})}}\n            >\n              <DetailPage \n                {...this.state.detail}\n                requests={this.state.requests}\n                invest={this.invest}\n                request={this.request}\n                vote={this.vote}\n                currentAccount={this.state.currentAccount}\n              />\n            </Modal>\n            <p>{this.state.currentAccount}: 欢迎使用iFunding！</p>\n            <Radio.Group size=\"large\" onChange={e => this.changeShownData(e.target.value)} defaultValue=\"所有项目\">\n              <Radio.Button value=\"所有项目\">所有项目</Radio.Button>\n              <Radio.Button value=\"我发起的项目\">我发起的项目</Radio.Button>\n              <Radio.Button value=\"我投资的项目\">我投资的项目</Radio.Button>\n              <Radio.Button value=\"未完成的项目\">未完成的项目</Radio.Button>\n            </Radio.Group>\n            <Table columns={this.state.columns} dataSource={this.state.shownData} pagination={{pageSize: 8}} />\n          </Spin>\n        </Content>\n        <Footer style={{ backgroundColor: \"rgba(0, 0, 0, 0.85)\", color: \"white\", textAlign: 'center' }}>iFunding ©2021 Created by NessOffice</Footer>\n      </Layout>\n    )\n  }\n};\n"]},"metadata":{},"sourceType":"module"}